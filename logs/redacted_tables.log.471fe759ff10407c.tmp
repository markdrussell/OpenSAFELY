-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/redacted_tables.log
  log type:  text
 opened on:  16 Jan 2023, 12:14:06

. 
. **Set Ado file path
. adopath + "$projectdir/analysis/extra_ados"
  [1]  (BASE)      "/usr/local/stata/ado/base/"
  [2]  (SITE)      "/usr/local/ado/"
  [3]              "."
  [4]  (PERSONAL)  "~/ado/personal/"
  [5]  (PLUS)      "~/ado/plus/"
  [6]  (OLDPLACE)  "~/ado/"
  [7]              "/workspace/analysis/extra_ados"

. 
. set scheme plotplainblind

. 
. **Set index dates ===========================================================
> */
. global year_preceding = "01/04/2018"

. global start_date = "01/04/2019"

. global appt_date = "01/04/2021"

. global end_date = "01/01/2023"

. 
. *Descriptive statistics======================================================
> ================*/
. 
. **Baseline table for all EIA patients
. clear *

. save "$projectdir/output/data/table_1_rounded_all.dta", replace emptyok
(note: dataset contains 0 observations)
file /workspace/output/data/table_1_rounded_all.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. foreach var of varlist has_12m_post_appt has_6m_post_appt last_gp_prerheum_to
> 21 last_gp_prerheum_to6m rheum_appt_to21 rheum_appt_to6m rheum_appt ckd chron
> ic_liver_disease chronic_resp_disease cancer stroke chronic_cardiac_disease d
> iabcatm hypertension smoke bmicat imd ethnicity male agegroup {
  2.         preserve
  3.         contract `var'
  4.         local v : variable label `var' 
  5.         gen variable = `"`v'"'
  6.     decode `var', gen(categories)
  7.         gen count = round(_freq, 5)
  8.         egen total = total(count)
  9.         egen non_missing=sum(count) if categories!="Not known"
 10.         drop if categories=="Not known"
 11.         gen percent = round((count/non_missing)*100, 0.1)
 12.         gen missing=(total-non_missing)
 13.         order total, after(percent)
 14.         order missing, after(total)
 15.         gen countstr = string(count)
 16.         replace countstr = "<8" if count<=7
 17.         order countstr, after(count)
 18.         drop count
 19.         rename countstr count_all
 20.         tostring percent, gen(percentstr) force format(%9.1f)
 21.         replace percentstr = "-" if count =="<8"
 22.         order percentstr, after(percent)
 23.         drop percent
 24.         rename percentstr percent_all
 25.         gen totalstr = string(total)
 26.         replace totalstr = "-" if count =="<8"
 27.         order totalstr, after(total)
 28.         drop total
 29.         rename totalstr total_all
 30.         gen missingstr = string(missing)
 31.         replace missingstr = "-" if count =="<8"
 32.         order missingstr, after(missing)
 33.         drop missing
 34.         rename missingstr missing
 35.         list variable categories count percent total missing
 36.         keep variable categories count percent total missing
 37.         append using "$projectdir/output/data/table_1_rounded_all.dta"
 38.         save "$projectdir/output/data/table_1_rounded_all.dta", replace
 39.         restore
 40. }
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +------------------------------------------------------------------------+
  1. |                   variable | catego~s | count_~l | percen~l | total_~l |
     | GP/rheum/registration 12m+ |       No |   107050 |     61.6 |   173810 |
     |------------------------------------------------------------------------|
     |                                missing                                 |
     |                                      0                                 |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  2. |                   variable | catego~s | count_~l | percen~l | total_~l |
     | GP/rheum/registration 12m+ |      Yes |    66760 |     38.4 |   173810 |
     |------------------------------------------------------------------------|
     |                                missing                                 |
     |                                      0                                 |
     +------------------------------------------------------------------------+
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-----------------------------------------------------------------------+
  1. |                  variable | catego~s | count_~l | percen~l | total_~l |
     | GP/rheum/registration 6m+ |       No |   103305 |     59.4 |   173810 |
     |-----------------------------------------------------------------------|
     |                                missing                                |
     |                                      0                                |
     +-----------------------------------------------------------------------+

     +-----------------------------------------------------------------------+
  2. |                  variable | catego~s | count_~l | percen~l | total_~l |
     | GP/rheum/registration 6m+ |      Yes |    70505 |     40.6 |   173810 |
     |-----------------------------------------------------------------------|
     |                                missing                                |
     |                                      0                                |
     +-----------------------------------------------------------------------+
(note: variable variable was str25, now str26 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +--------------------------------------------------------------------+
  1. |               variable | catego~s | count_~l | percen~l | total_~l |
     | GP and rheum appt 12m+ |       No |    99795 |     57.4 |   173810 |
     |--------------------------------------------------------------------|
     |                              missing                               |
     |                                    0                               |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  2. |               variable | catego~s | count_~l | percen~l | total_~l |
     | GP and rheum appt 12m+ |      Yes |    74015 |     42.6 |   173810 |
     |--------------------------------------------------------------------|
     |                              missing                               |
     |                                    0                               |
     +--------------------------------------------------------------------+
(note: variable variable was str22, now str26 to accommodate using data's
       values)
(note: variable count_all was str5, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------------------------------+
  1. |              variable | catego~s | count_~l | percen~l | total_~l |
     | GP and rheum appt 6m+ |       No |    99630 |     57.3 |   173810 |
     |-------------------------------------------------------------------|
     |                              missing                              |
     |                                    0                              |
     +-------------------------------------------------------------------+

     +-------------------------------------------------------------------+
  2. |              variable | catego~s | count_~l | percen~l | total_~l |
     | GP and rheum appt 6m+ |      Yes |    74180 |     42.7 |   173810 |
     |-------------------------------------------------------------------|
     |                              missing                              |
     |                                    0                              |
     +-------------------------------------------------------------------+
(note: variable variable was str21, now str26 to accommodate using data's
       values)
(note: variable count_all was str5, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +--------------------------------------------------------------------+
  1. |               variable | catego~s | count_~l | percen~l | total_~l |
     | Rheumatology appt 12m+ |       No |    91475 |     52.6 |   173810 |
     |--------------------------------------------------------------------|
     |                              missing                               |
     |                                    0                               |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  2. |               variable | catego~s | count_~l | percen~l | total_~l |
     | Rheumatology appt 12m+ |      Yes |    82335 |     47.4 |   173810 |
     |--------------------------------------------------------------------|
     |                              missing                               |
     |                                    0                               |
     +--------------------------------------------------------------------+
(note: variable variable was str22, now str26 to accommodate using data's
       values)
(note: variable count_all was str5, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------------------------------+
  1. |              variable | catego~s | count_~l | percen~l | total_~l |
     | Rheumatology appt 6m+ |       No |    91290 |     52.5 |   173810 |
     |-------------------------------------------------------------------|
     |                              missing                              |
     |                                    0                              |
     +-------------------------------------------------------------------+

     +-------------------------------------------------------------------+
  2. |              variable | catego~s | count_~l | percen~l | total_~l |
     | Rheumatology appt 6m+ |      Yes |    82520 |     47.5 |   173810 |
     |-------------------------------------------------------------------|
     |                              missing                              |
     |                                    0                              |
     +-------------------------------------------------------------------+
(note: variable variable was str21, now str26 to accommodate using data's
       values)
(note: variable count_all was str5, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +----------------------------------------------------------------------+
  1. |                 variable | catego~s | count_~l | percen~l | total_~l |
     | Rheumatology appointment |       No |    91245 |     52.5 |   173810 |
     |----------------------------------------------------------------------|
     |                               missing                                |
     |                                     0                                |
     +----------------------------------------------------------------------+

     +----------------------------------------------------------------------+
  2. |                 variable | catego~s | count_~l | percen~l | total_~l |
     | Rheumatology appointment |      Yes |    82565 |     47.5 |   173810 |
     |----------------------------------------------------------------------|
     |                               missing                                |
     |                                     0                                |
     +----------------------------------------------------------------------+
(note: variable variable was str24, now str26 to accommodate using data's
       values)
(note: variable count_all was str5, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +--------------------------------------------------------------------+
  1. |               variable | catego~s | count_~l | percen~l | total_~l |
     | Chronic kidney disease |       No |    77645 |     44.7 |   173810 |
     |--------------------------------------------------------------------|
     |                              missing                               |
     |                                    0                               |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  2. |               variable | catego~s | count_~l | percen~l | total_~l |
     | Chronic kidney disease |      Yes |    96165 |     55.3 |   173810 |
     |--------------------------------------------------------------------|
     |                              missing                               |
     |                                    0                               |
     +--------------------------------------------------------------------+
(note: variable variable was str22, now str26 to accommodate using data's
       values)
(note: variable count_all was str5, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------------------------------+
  1. |              variable | catego~s | count_~l | percen~l | total_~l |
     | Chronic liver disease |       No |   139080 |     80.0 |   173810 |
     |-------------------------------------------------------------------|
     |                              missing                              |
     |                                    0                              |
     +-------------------------------------------------------------------+

     +-------------------------------------------------------------------+
  2. |              variable | catego~s | count_~l | percen~l | total_~l |
     | Chronic liver disease |      Yes |    34730 |     20.0 |   173810 |
     |-------------------------------------------------------------------|
     |                              missing                              |
     |                                    0                              |
     +-------------------------------------------------------------------+
(note: variable variable was str21, now str26 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +--------------------------------------------------------------+
  1. |                    variable | catego~s | count_~l | percen~l |
     | Chronic respiratory disease |       No |   139055 |     80.0 |
     |--------------------------------------------------------------|
     |           total_~l            |           missing            |
     |             173810            |                 0            |
     +--------------------------------------------------------------+

     +--------------------------------------------------------------+
  2. |                    variable | catego~s | count_~l | percen~l |
     | Chronic respiratory disease |      Yes |    34755 |     20.0 |
     |--------------------------------------------------------------|
     |           total_~l            |           missing            |
     |             173810            |                 0            |
     +--------------------------------------------------------------+
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +----------------------------------------------------------------+
     | variable   catego~s   count_~l   percen~l   total_~l   missing |
     |----------------------------------------------------------------|
  1. |   Cancer         No      88820       51.1     173810         0 |
  2. |   Cancer        Yes      84990       48.9     173810         0 |
     +----------------------------------------------------------------+
(note: variable variable was str6, now str27 to accommodate using data's
       values)
(note: variable count_all was str5, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +----------------------------------------------------------------+
     | variable   catego~s   count_~l   percen~l   total_~l   missing |
     |----------------------------------------------------------------|
  1. |   Stroke         No     139040       80.0     173810         0 |
  2. |   Stroke        Yes      34770       20.0     173810         0 |
     +----------------------------------------------------------------+
(note: variable variable was str6, now str27 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +---------------------------------------------------------------------+
  1. |                variable | catego~s | count_~l | percen~l | total_~l |
     | Chronic cardiac disease |       No |   139235 |     80.1 |   173810 |
     |---------------------------------------------------------------------|
     |                               missing                               |
     |                                     0                               |
     +---------------------------------------------------------------------+

     +---------------------------------------------------------------------+
  2. |                variable | catego~s | count_~l | percen~l | total_~l |
     | Chronic cardiac disease |      Yes |    34575 |     19.9 |   173810 |
     |---------------------------------------------------------------------|
     |                               missing                               |
     |                                     0                               |
     +---------------------------------------------------------------------+
(note: variable variable was str23, now str27 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +------------------------------------------------------------------+
  1. | variable |                      categories | count_~l | percen~l |
     | Diabetes |                     No diabetes |   139190 |     80.1 |
     |------------------------------------------------------------------|
     |            total_~l             |            missing             |
     |              173815             |                  0             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  2. | variable |                      categories | count_~l | percen~l |
     | Diabetes | Diabetes with HbA1c <58mmol/mol |     1780 |      1.0 |
     |------------------------------------------------------------------|
     |            total_~l             |            missing             |
     |              173815             |                  0             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  3. | variable |                      categories | count_~l | percen~l |
     | Diabetes | Diabetes with HbA1c >58mmol/mol |      325 |      0.2 |
     |------------------------------------------------------------------|
     |            total_~l             |            missing             |
     |              173815             |                  0             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  4. | variable |                      categories | count_~l | percen~l |
     | Diabetes |  Diabetes with no HbA1c measure |    32520 |     18.7 |
     |------------------------------------------------------------------|
     |            total_~l             |            missing             |
     |              173815             |                  0             |
     +------------------------------------------------------------------+
(note: variable variable was str8, now str27 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +--------------------------------------------------------------------+
     |     variable   catego~s   count_~l   percen~l   total_~l   missing |
     |--------------------------------------------------------------------|
  1. | Hypertension         No     139110       80.0     173810         0 |
  2. | Hypertension        Yes      34700       20.0     173810         0 |
     +--------------------------------------------------------------------+
(note: variable variable was str12, now str27 to accommodate using data's
       values)
(note: variable categories was str3, now str31 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +----------------------------------------------------------------------+
     |       variable   catego~s   count_~l   percen~l   total_~l   missing |
     |----------------------------------------------------------------------|
  1. | Smoking status      Never      17265       22.1     173810     95805 |
  2. | Smoking status     Former       8730       11.2     173810     95805 |
  3. | Smoking status    Current      52010       66.7     173810     95805 |
     +----------------------------------------------------------------------+
(note: variable variable was str14, now str27 to accommodate using data's
       values)
(note: variable categories was str9, now str31 to accommodate using data's
       values)
(note: variable count_all was str5, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +------------------------------------------------------------------+
  1. | variable |           categories | count_~l | percen~l | total_~l |
     |      BMI |  Underweight (<18.5) |      400 |      4.1 |   173810 |
     |------------------------------------------------------------------|
     |                             missing                              |
     |                              164005                              |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  2. | variable |           categories | count_~l | percen~l | total_~l |
     |      BMI |   Normal (18.5-24.9) |     1040 |     10.6 |   173810 |
     |------------------------------------------------------------------|
     |                             missing                              |
     |                              164005                              |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  3. | variable |           categories | count_~l | percen~l | total_~l |
     |      BMI | Overweight (25-29.9) |     1560 |     15.9 |   173810 |
     |------------------------------------------------------------------|
     |                             missing                              |
     |                              164005                              |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  4. | variable |           categories | count_~l | percen~l | total_~l |
     |      BMI |    Obese I (30-34.9) |     1915 |     19.5 |   173810 |
     |------------------------------------------------------------------|
     |                             missing                              |
     |                              164005                              |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  5. | variable |           categories | count_~l | percen~l | total_~l |
     |      BMI |   Obese II (35-39.9) |     1915 |     19.5 |   173810 |
     |------------------------------------------------------------------|
     |                             missing                              |
     |                              164005                              |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  6. | variable |           categories | count_~l | percen~l | total_~l |
     |      BMI |      Obese III (40+) |     2975 |     30.3 |   173810 |
     |------------------------------------------------------------------|
     |                             missing                              |
     |                              164005                              |
     +------------------------------------------------------------------+
(note: variable variable was str3, now str27 to accommodate using data's
       values)
(note: variable categories was str20, now str31 to accommodate using data's
       values)
(note: variable count_all was str4, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +------------------------------------------------------------------------+
  1. |                      variable |       categories | count_~l | percen~l |
     | Index of multiple deprivation |  1 most deprived |    32930 |     19.9 |
     |------------------------------------------------------------------------|
     |              total_~l              |              missing              |
     |                173815              |                 8680              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  2. |                      variable |       categories | count_~l | percen~l |
     | Index of multiple deprivation |                2 |    32900 |     19.9 |
     |------------------------------------------------------------------------|
     |              total_~l              |              missing              |
     |                173815              |                 8680              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  3. |                      variable |       categories | count_~l | percen~l |
     | Index of multiple deprivation |                3 |    33025 |     20.0 |
     |------------------------------------------------------------------------|
     |              total_~l              |              missing              |
     |                173815              |                 8680              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  4. |                      variable |       categories | count_~l | percen~l |
     | Index of multiple deprivation |                4 |    33300 |     20.2 |
     |------------------------------------------------------------------------|
     |              total_~l              |              missing              |
     |                173815              |                 8680              |
     +------------------------------------------------------------------------+

     +------------------------------------------------------------------------+
  5. |                      variable |       categories | count_~l | percen~l |
     | Index of multiple deprivation | 5 least deprived |    32980 |     20.0 |
     |------------------------------------------------------------------------|
     |              total_~l              |              missing              |
     |                173815              |                 8680              |
     +------------------------------------------------------------------------+
(note: variable categories was str16, now str31 to accommodate using data's
       values)
(note: variable count_all was str5, now str6 to accommodate using data's
       values)
(note: variable missing was str4, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +------------------------------------------------------------------+
  1. |  variable |          categories | count_~l | percen~l | total_~l |
     | Ethnicity |               White |    65420 |     50.2 |   173805 |
     |------------------------------------------------------------------|
     |                             missing                              |
     |                               43370                              |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  2. |  variable |          categories | count_~l | percen~l | total_~l |
     | Ethnicity | Asian/Asian British |    13010 |     10.0 |   173805 |
     |------------------------------------------------------------------|
     |                             missing                              |
     |                               43370                              |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  3. |  variable |          categories | count_~l | percen~l | total_~l |
     | Ethnicity |               Black |    13040 |     10.0 |   173805 |
     |------------------------------------------------------------------|
     |                             missing                              |
     |                               43370                              |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  4. |  variable |          categories | count_~l | percen~l | total_~l |
     | Ethnicity |         Mixed/Other |    38965 |     29.9 |   173805 |
     |------------------------------------------------------------------|
     |                             missing                              |
     |                               43370                              |
     +------------------------------------------------------------------+
(note: variable variable was str9, now str29 to accommodate using data's
       values)
(note: variable categories was str19, now str31 to accommodate using data's
       values)
(note: variable count_all was str5, now str6 to accommodate using data's
       values)
(note: variable missing was str5, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +----------------------------------------------------------------+
     | variable   catego~s   count_~l   percen~l   total_~l   missing |
     |----------------------------------------------------------------|
  1. |     Male         No      88540       50.9     173810         0 |
  2. |     Male        Yes      85270       49.1     173810         0 |
     +----------------------------------------------------------------+
(note: variable variable was str4, now str29 to accommodate using data's
       values)
(note: variable categories was str3, now str31 to accommodate using data's
       values)
(note: variable count_all was str5, now str6 to accommodate using data's
       values)
(note: variable missing was str1, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-----------------------------------------------------------------+
     |  variable   catego~s   count_~l   percen~l   total_~l   missing |
     |-----------------------------------------------------------------|
  1. | Age group      18-39      63110       36.3     173810         0 |
  2. | Age group      40-49      28210       16.2     173810         0 |
  3. | Age group      50-59      29870       17.2     173810         0 |
  4. | Age group      60-69      23500       13.5     173810         0 |
  5. | Age group      70-79      18265       10.5     173810         0 |
     |-----------------------------------------------------------------|
  6. | Age group        80+      10855        6.2     173810         0 |
     +-----------------------------------------------------------------+
(note: variable variable was str9, now str29 to accommodate using data's
       values)
(note: variable categories was str5, now str31 to accommodate using data's
       values)
(note: variable count_all was str5, now str6 to accommodate using data's
       values)
(note: variable missing was str1, now str6 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_all.dta saved

. use "$projectdir/output/data/table_1_rounded_all.dta", clear

. export excel "$projectdir/output/tables/table_1_rounded_bydiag.xls", replace 
> sheet("Overall") keepcellfmt firstrow(variables)
file /workspace/output/tables/table_1_rounded_bydiag.xls saved

. 
. **Baseline table for EIA subdiagnoses - tagged to above excel
. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. local index=0

. levelsof eia_diag, local(levels)
`"AxSpA"' `"PsA"' `"RA"' `"Undiff_IA"'

. foreach i of local levels {
  2.         clear *
  3.         save "$projectdir/output/data/table_1_rounded_`i'.dta", replace em
> ptyok
  4.         di `index'
  5.         if `index'==0 {
  6.                 local col = word("`c(ALPHA)'", `index'+6)
  7.         }
  8.         else if `index'>0 & `index'<=22 {
  9.             local col = word("`c(ALPHA)'", `index'+4)
 10.         }
 11.         di "`col'"
 12.         if `index'==0 {
 13.                 local `index++'
 14.                 local `index++'
 15.                 local `index++'
 16.                 local `index++'
 17.                 local `index++'
 18.                 local `index++'
 19.         }
 20.         else {
 21.             local `index++'
 22.                 local `index++'
 23.                 local `index++'
 24.                 local `index++'
 25.         }
 26.         di `index'
 27. 
. use "$projectdir/output/data/file_eia_all.dta", clear
 28. 
. foreach var of varlist has_12m_post_appt has_6m_post_appt last_gp_prerheum_to
> 21 last_gp_prerheum_to6m rheum_appt_to21 rheum_appt_to6m rheum_appt ckd chron
> ic_liver_disease chronic_resp_disease cancer stroke chronic_cardiac_disease d
> iabcatm hypertension smoke bmicat imd ethnicity male agegroup {
 29.         preserve
 30.         keep if eia_diag=="`i'"
 31.         contract `var'
 32.         local v : variable label `var' 
 33.         gen variable = `"`v'"'
 34.     decode `var', gen(categories)
 35.         gen count = round(_freq, 5)
 36.         egen total = total(count)
 37.         egen non_missing=sum(count) if categories!="Not known"
 38.         drop if categories=="Not known"
 39.         gen percent = round((count/non_missing)*100, 0.1)
 40.         gen missing=(total-non_missing)
 41.         order total, after(percent)
 42.         order missing, after(total)
 43.         gen countstr = string(count)
 44.         replace countstr = "<8" if count<=7
 45.         order countstr, after(count)
 46.         drop count
 47.         rename countstr count_`i'
 48.         tostring percent, gen(percentstr) force format(%9.1f)
 49.         replace percentstr = "-" if count =="<8"
 50.         order percentstr, after(percent)
 51.         drop percent
 52.         rename percentstr percent_`i'
 53.         gen totalstr = string(total)
 54.         replace totalstr = "-" if count =="<8"
 55.         order totalstr, after(total)
 56.         drop total
 57.         rename totalstr total_`i'
 58.         gen missingstr = string(missing)
 59.         replace missingstr = "-" if count =="<8"
 60.         order missingstr, after(missing)
 61.         drop missing
 62.         rename missingstr missing_`i'
 63.         list count percent total missing
 64.         keep count percent total missing
 65.         append using "$projectdir/output/data/table_1_rounded_`i'.dta"
 66.         save "$projectdir/output/data/table_1_rounded_`i'.dta", replace
 67.         restore
 68. }
 69. display `index'
 70. display "`col'"
 71. use "$projectdir/output/data/table_1_rounded_`i'.dta", clear
 72. export excel "$projectdir/output/tables/table_1_rounded_bydiag.xls", sheet
> ("Overall", modify) cell("`col'1") keepcellfmt firstrow(variables)
 73. }
(note: dataset contains 0 observations)
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
0
F
6
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    26625       61.4      43355          0 |
  2. |    16730       38.6      43355          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    25670       59.2      43355          0 |
  2. |    17685       40.8      43355          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    24815       57.2      43360          0 |
  2. |    18545       42.8      43360          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    24770       57.1      43355          0 |
  2. |    18585       42.9      43355          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22805       52.6      43355          0 |
  2. |    20550       47.4      43355          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22755       52.5      43355          0 |
  2. |    20600       47.5      43355          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22740       52.4      43360          0 |
  2. |    20620       47.6      43360          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    19480       44.9      43360          0 |
  2. |    23880       55.1      43360          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34655       79.9      43355          0 |
  2. |     8700       20.1      43355          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34600       79.8      43360          0 |
  2. |     8760       20.2      43360          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22095       51.0      43355          0 |
  2. |    21260       49.0      43355          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34705       80.0      43360          0 |
  2. |     8655       20.0      43360          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34600       79.8      43355          0 |
  2. |     8755       20.2      43355          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34720       80.1      43355          0 |
  2. |      455        1.0      43355          0 |
  3. |       90        0.2      43355          0 |
  4. |     8090       18.7      43355          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34535       79.6      43360          0 |
  2. |     8825       20.4      43360          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |     4220       21.8      43355      23980 |
  2. |     2185       11.3      43355      23980 |
  3. |    12970       66.9      43355      23980 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |       95        3.9      43355      40890 |
  2. |      280       11.4      43355      40890 |
  3. |      370       15.0      43355      40890 |
  4. |      460       18.7      43355      40890 |
  5. |      470       19.1      43355      40890 |
     |-------------------------------------------|
  6. |      790       32.0      43355      40890 |
     +-------------------------------------------+
(note: variable count_AxSpA was str3, now str5 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |     8205       19.9      43355       2120 |
  2. |     8310       20.2      43355       2120 |
  3. |     8220       19.9      43355       2120 |
  4. |     8215       19.9      43355       2120 |
  5. |     8285       20.1      43355       2120 |
     +-------------------------------------------+
(note: variable count_AxSpA was str4, now str5 to accommodate using data's
       values)
(note: variable missing_AxSpA was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    16390       50.5      43355      10870 |
  2. |     3225        9.9      43355      10870 |
  3. |     3250       10.0      43355      10870 |
  4. |     9620       29.6      43355      10870 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22110       51.0      43355          0 |
  2. |    21245       49.0      43355          0 |
     +-------------------------------------------+
(note: variable missing_AxSpA was str1, now str5 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
(130,453 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    15845       36.5      43360          0 |
  2. |     6900       15.9      43360          0 |
  3. |     7525       17.4      43360          0 |
  4. |     5825       13.4      43360          0 |
  5. |     4535       10.5      43360          0 |
     |-------------------------------------------|
  6. |     2730        6.3      43360          0 |
     +-------------------------------------------+
(note: variable missing_AxSpA was str1, now str5 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_AxSpA.dta saved
6
F
file /workspace/output/tables/table_1_rounded_bydiag.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_1_rounded_PsA.dta saved
6
J
10
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    26880       61.5      43690          0 |
  2. |    16810       38.5      43690          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    25940       59.4      43690          0 |
  2. |    17750       40.6      43690          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    25035       57.3      43690          0 |
  2. |    18655       42.7      43690          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    24995       57.2      43690          0 |
  2. |    18695       42.8      43690          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22945       52.5      43685          0 |
  2. |    20740       47.5      43685          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22905       52.4      43690          0 |
  2. |    20785       47.6      43690          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22895       52.4      43690          0 |
  2. |    20795       47.6      43690          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    19465       44.6      43690          0 |
  2. |    24225       55.4      43690          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34880       79.8      43685          0 |
  2. |     8805       20.2      43685          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34960       80.0      43685          0 |
  2. |     8725       20.0      43685          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22420       51.3      43690          0 |
  2. |    21270       48.7      43690          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34905       79.9      43690          0 |
  2. |     8785       20.1      43690          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34995       80.1      43685          0 |
  2. |     8690       19.9      43685          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34865       79.8      43690          0 |
  2. |      425        1.0      43690          0 |
  3. |       70        0.2      43690          0 |
  4. |     8330       19.1      43690          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    35010       80.1      43690          0 |
  2. |     8680       19.9      43690          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |     4340       22.2      43685      24110 |
  2. |     2110       10.8      43685      24110 |
  3. |    13125       67.0      43685      24110 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |       95        3.9      43690      41225 |
  2. |      260       10.5      43690      41225 |
  3. |      395       16.0      43690      41225 |
  4. |      495       20.1      43690      41225 |
  5. |      500       20.3      43690      41225 |
     |-------------------------------------------|
  6. |      720       29.2      43690      41225 |
     +-------------------------------------------+
(note: variable count_PsA was str3, now str5 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |     8300       20.0      43685       2230 |
  2. |     8270       19.9      43685       2230 |
  3. |     8205       19.8      43685       2230 |
  4. |     8385       20.2      43685       2230 |
  5. |     8295       20.0      43685       2230 |
     +-------------------------------------------+
(note: variable count_PsA was str4, now str5 to accommodate using data's
       values)
(note: variable missing_PsA was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    16455       50.2      43690      10920 |
  2. |     3265       10.0      43690      10920 |
  3. |     3235        9.9      43690      10920 |
  4. |     9815       30.0      43690      10920 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22165       50.7      43690          0 |
  2. |    21525       49.3      43690          0 |
     +-------------------------------------------+
(note: variable missing_PsA was str1, now str5 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_PsA.dta saved
(130,122 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    15805       36.2      43685          0 |
  2. |     7150       16.4      43685          0 |
  3. |     7495       17.2      43685          0 |
  4. |     5955       13.6      43685          0 |
  5. |     4610       10.6      43685          0 |
     |-------------------------------------------|
  6. |     2670        6.1      43685          0 |
     +-------------------------------------------+
(note: variable missing_PsA was str1, now str5 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_PsA.dta saved
10
J
file /workspace/output/tables/table_1_rounded_bydiag.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_1_rounded_RA.dta saved
10
N
14
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    26740       61.5      43485          0 |
  2. |    16745       38.5      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    25845       59.4      43485          0 |
  2. |    17640       40.6      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    24925       57.3      43485          0 |
  2. |    18560       42.7      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    24885       57.2      43480          0 |
  2. |    18595       42.8      43480          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    22875       52.6      43485          0 |
  2. |    20610       47.4      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    22835       52.5      43485          0 |
  2. |    20650       47.5      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    22820       52.5      43485          0 |
  2. |    20665       47.5      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    19415       44.6      43485          0 |
  2. |    24070       55.4      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    34855       80.2      43485          0 |
  2. |     8630       19.8      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    34905       80.3      43485          0 |
  2. |     8580       19.7      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    22180       51.0      43485          0 |
  2. |    21305       49.0      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    34955       80.4      43485          0 |
  2. |     8530       19.6      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    34955       80.4      43485          0 |
  2. |     8530       19.6      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    34990       80.5      43485          0 |
  2. |      430        1.0      43485          0 |
  3. |       90        0.2      43485          0 |
  4. |     7975       18.3      43485          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    34840       80.1      43480          0 |
  2. |     8640       19.9      43480          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |     4265       21.9      43480      23980 |
  2. |     2195       11.3      43480      23980 |
  3. |    13040       66.9      43480      23980 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |      105        4.3      43485      41025 |
  2. |      265       10.8      43485      41025 |
  3. |      375       15.2      43485      41025 |
  4. |      490       19.9      43485      41025 |
  5. |      480       19.5      43485      41025 |
     |-------------------------------------------|
  6. |      745       30.3      43485      41025 |
     +-------------------------------------------+
(note: variable count_RA was str3, now str5 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |     8305       20.1      43480       2190 |
  2. |     8105       19.6      43480       2190 |
  3. |     8385       20.3      43480       2190 |
  4. |     8270       20.0      43480       2190 |
  5. |     8225       19.9      43480       2190 |
     +-------------------------------------------+
(note: variable count_RA was str4, now str5 to accommodate using data's
       values)
(note: variable missing_RA was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    16415       50.3      43485      10860 |
  2. |     3260       10.0      43485      10860 |
  3. |     3285       10.1      43485      10860 |
  4. |     9665       29.6      43485      10860 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    22135       50.9      43485          0 |
  2. |    21350       49.1      43485          0 |
     +-------------------------------------------+
(note: variable missing_RA was str1, now str5 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_RA.dta saved
(130,326 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_RA   percen~A   total_RA   missin~A |
     |-------------------------------------------|
  1. |    15700       36.1      43480          0 |
  2. |     7155       16.5      43480          0 |
  3. |     7510       17.3      43480          0 |
  4. |     5825       13.4      43480          0 |
  5. |     4600       10.6      43480          0 |
     |-------------------------------------------|
  6. |     2690        6.2      43480          0 |
     +-------------------------------------------+
(note: variable missing_RA was str1, now str5 to accommodate using data's
       values)
file /workspace/output/data/table_1_rounded_RA.dta saved
14
N
file /workspace/output/tables/table_1_rounded_bydiag.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
14
R
18
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    26805       61.9      43280          0 |
  2. |    16475       38.1      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    25850       59.7      43280          0 |
  2. |    17430       40.3      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    25020       57.8      43280          0 |
  2. |    18260       42.2      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    24975       57.7      43280          0 |
  2. |    18305       42.3      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22850       52.8      43280          0 |
  2. |    20430       47.2      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22800       52.7      43280          0 |
  2. |    20480       47.3      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22790       52.7      43280          0 |
  2. |    20490       47.3      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    19285       44.6      43280          0 |
  2. |    23995       55.4      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34690       80.2      43280          0 |
  2. |     8590       19.8      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34595       79.9      43285          0 |
  2. |     8690       20.1      43285          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22125       51.1      43280          0 |
  2. |    21155       48.9      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34480       79.7      43280          0 |
  2. |     8800       20.3      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34685       80.1      43280          0 |
  2. |     8595       19.9      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34615       80.0      43285          0 |
  2. |      470        1.1      43285          0 |
  3. |       75        0.2      43285          0 |
  4. |     8125       18.8      43285          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    34725       80.2      43280          0 |
  2. |     8555       19.8      43280          0 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |     4430       22.7      43280      23735 |
  2. |     2240       11.5      43280      23735 |
  3. |    12875       65.9      43280      23735 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |      100        4.1      43280      40865 |
  2. |      240        9.9      43280      40865 |
  3. |      420       17.4      43280      40865 |
  4. |      475       19.7      43280      40865 |
  5. |      465       19.3      43280      40865 |
     |-------------------------------------------|
  6. |      715       29.6      43280      40865 |
     +-------------------------------------------+
(note: variable count_Undiff_IA was str3, now str5 to accommodate using
       data's values)
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |     8120       19.7      43285       2135 |
  2. |     8215       20.0      43285       2135 |
  3. |     8215       20.0      43285       2135 |
  4. |     8430       20.5      43285       2135 |
  5. |     8170       19.9      43285       2135 |
     +-------------------------------------------+
(note: variable count_Undiff_IA was str4, now str5 to accommodate using
       data's values)
(note: variable missing_Undiff_IA was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    16160       49.6      43280      10720 |
  2. |     3260       10.0      43280      10720 |
  3. |     3275       10.1      43280      10720 |
  4. |     9865       30.3      43280      10720 |
     +-------------------------------------------+
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    22130       51.1      43280          0 |
  2. |    21150       48.9      43280          0 |
     +-------------------------------------------+
(note: variable missing_Undiff_IA was str1, now str5 to accommodate using
       data's values)
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
(130,529 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~A   percen~A   total_~A   missin~A |
     |-------------------------------------------|
  1. |    15765       36.4      43280          0 |
  2. |     7000       16.2      43280          0 |
  3. |     7340       17.0      43280          0 |
  4. |     5890       13.6      43280          0 |
  5. |     4525       10.5      43280          0 |
     |-------------------------------------------|
  6. |     2760        6.4      43280          0 |
     +-------------------------------------------+
(note: variable missing_Undiff_IA was str1, now str5 to accommodate using
       data's values)
file /workspace/output/data/table_1_rounded_Undiff_IA.dta saved
18
R
file /workspace/output/tables/table_1_rounded_bydiag.xls saved

. 
. **Table of mean outputs - full study period
. clear *

. save "$projectdir/output/data/table_mean_bydiag_rounded.dta", replace emptyok
(note: dataset contains 0 observations)
file /workspace/output/data/table_mean_bydiag_rounded.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. foreach var of varlist rheum_appt_count age {
  2.         preserve
  3.         collapse (count) "`var'_count"=`var' (mean) mean=`var' (sd) stdev=
> `var', by(eia_diagnosis)
  4.         gen varn = "`var'_count"
  5.         gen variable = substr(varn, 1, strpos(varn, "_count") - 1)
  6.         drop varn
  7.         rename *count freq
  8.         gen count = round(freq, 5)
  9.     decode eia_diagnosis, gen(diagnosis)
 10.         gen countstr = string(count)
 11.         replace countstr = "<8" if count<=7
 12.         order countstr, after(count)
 13.         drop count
 14.         rename countstr count
 15.         tostring mean, gen(meanstr) force format(%9.1f)
 16.         replace meanstr = "-" if count =="<8"
 17.         order meanstr, after(mean)
 18.         drop mean
 19.         rename meanstr mean
 20.         tostring stdev, gen(stdevstr) force format(%9.1f)
 21.         replace stdevstr = "-" if count =="<8"
 22.         order stdevstr, after(stdev)
 23.         drop stdev
 24.         rename stdevstr stdev
 25.         order count, first
 26.         order diagnosis, first
 27.         order variable, first
 28.         list variable diagnosis count mean stdev
 29.         keep variable diagnosis count mean stdev
 30.         append using "$projectdir/output/data/table_mean_bydiag_rounded.dt
> a"
 31.         save "$projectdir/output/data/table_mean_bydiag_rounded.dta", repl
> ace
 32.         restore
 33.         preserve
 34.         collapse (count) "`var'_count"=`var' (mean) mean=`var' (sd) stdev=
> `var'
 35.         gen varn = "`var'_count"
 36.         gen variable = substr(varn, 1, strpos(varn, "_count") - 1)
 37.         drop varn
 38.         rename *count freq
 39.         gen count = round(freq, 5)
 40.         gen countstr = string(count)
 41.         replace countstr = "<8" if count<=7
 42.         order countstr, after(count)
 43.         drop count
 44.         rename countstr count
 45.         tostring mean, gen(meanstr) force format(%9.1f)
 46.         replace meanstr = "-" if count =="<8"
 47.         order meanstr, after(mean)
 48.         drop mean
 49.         rename meanstr mean
 50.         tostring stdev, gen(stdevstr) force format(%9.1f)
 51.         replace stdevstr = "-" if count =="<8"
 52.         order stdevstr, after(stdev)
 53.         drop stdev
 54.         rename stdevstr stdev
 55.         gen diagnosis = "Total"
 56.         order count, first
 57.         order diagnosis, first
 58.         order variable, first
 59.         list variable diagnosis count mean stdev
 60.         keep variable diagnosis count mean stdev
 61.         append using "$projectdir/output/data/table_mean_bydiag_rounded.dt
> a"
 62.         save "$projectdir/output/data/table_mean_bydiag_rounded.dta", repl
> ace
 63.         restore
 64. } 
(0 real changes made)
meanstr generated as str3
meanstr was forced to string; some loss of information
(0 real changes made)
stdevstr generated as str3
stdevstr was forced to string; some loss of information
(0 real changes made)

     +-----------------------------------------------+
     |   variable   diagnosis   count   mean   stdev |
     |-----------------------------------------------|
  1. | rheum_appt          RA   43485    1.5     1.8 |
  2. | rheum_appt         PsA   43690    1.5     1.8 |
  3. | rheum_appt       AxSpA   43355    1.5     1.8 |
  4. | rheum_appt   Undiff IA   43280    1.5     1.8 |
     +-----------------------------------------------+
file /workspace/output/data/table_mean_bydiag_rounded.dta saved
(0 real changes made)
meanstr generated as str3
meanstr was forced to string; some loss of information
(0 real changes made)
stdevstr generated as str3
stdevstr was forced to string; some loss of information
(0 real changes made)

     +-----------------------------------------------+
     |   variable   diagno~s    count   mean   stdev |
     |-----------------------------------------------|
  1. | rheum_appt      Total   173810    1.5     1.8 |
     +-----------------------------------------------+
(note: variable diagnosis was str5, now str9 to accommodate using data's
       values)
file /workspace/output/data/table_mean_bydiag_rounded.dta saved
(0 real changes made)
meanstr generated as str4
meanstr was forced to string; some loss of information
(0 real changes made)
stdevstr generated as str4
stdevstr was forced to string; some loss of information
(0 real changes made)

     +---------------------------------------------+
     | variable   diagnosis   count   mean   stdev |
     |---------------------------------------------|
  1. |      age          RA   43485   48.9    18.9 |
  2. |      age         PsA   43690   48.9    18.9 |
  3. |      age       AxSpA   43355   48.8    19.0 |
  4. |      age   Undiff IA   43280   48.9    19.1 |
     +---------------------------------------------+
(note: variable variable was str3, now str10 to accommodate using data's
       values)
(note: variable count was str5, now str6 to accommodate using data's values)
file /workspace/output/data/table_mean_bydiag_rounded.dta saved
(0 real changes made)
meanstr generated as str4
meanstr was forced to string; some loss of information
(0 real changes made)
stdevstr generated as str4
stdevstr was forced to string; some loss of information
(0 real changes made)

     +---------------------------------------------+
     | variable   diagno~s    count   mean   stdev |
     |---------------------------------------------|
  1. |      age      Total   173810   48.9    19.0 |
     +---------------------------------------------+
(note: variable variable was str3, now str10 to accommodate using data's
       values)
(note: variable diagnosis was str5, now str9 to accommodate using data's
       values)
file /workspace/output/data/table_mean_bydiag_rounded.dta saved

. 
. use "$projectdir/output/data/table_mean_bydiag_rounded.dta", clear

. export excel "$projectdir/output/tables/table_mean_bydiag_rounded.xls", repla
> ce keepcellfmt firstrow(variables)
file /workspace/output/tables/table_mean_bydiag_rounded.xls saved

. 
. **Table of median/IQR outputs - full study period
. clear *

. save "$projectdir/output/data/table_median_bydiag_rounded.dta", replace empty
> ok
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. foreach var of varlist time_gp_rheum_appt time_rheum_eia_code {
  2.         preserve
  3.         collapse (count) "`var'_count"=`var' (p50) p50_un=`var' (p25) p25_
> un=`var' (p75) p75_un=`var', by(eia_diagnosis)
  4.         gen varn = "`var'_count"
  5.         gen variable = substr(varn, 1, strpos(varn, "_count") - 1)
  6.         drop varn
  7.         rename *count freq
  8.         gen count = round(freq, 5)
  9.         gen p50 = round(p50_un, 1)
 10.         gen p25 = round(p25_un, 1)
 11.         gen p75 = round(p75_un, 1)
 12.     decode eia_diagnosis, gen(diagnosis)
 13.         order count, first
 14.         order diagnosis, first
 15.         order variable, first
 16.         list variable diagnosis count p50 p25 p75
 17.         keep variable diagnosis count p50 p25 p75
 18.         append using "$projectdir/output/data/table_median_bydiag_rounded.
> dta"
 19.         save "$projectdir/output/data/table_median_bydiag_rounded.dta", re
> place
 20.         restore
 21.         preserve
 22.         collapse (count) "`var'_count"=`var' (p50) p50_un=`var' (p25) p25_
> un=`var' (p75) p75_un=`var'
 23.         gen varn = "`var'_count"
 24.         gen variable = substr(varn, 1, strpos(varn, "_count") - 1)
 25.         drop varn
 26.         rename *count freq
 27.         gen count = round(freq, 5)
 28.         gen p50 = round(p50_un, 1)
 29.         gen p25 = round(p25_un, 1)
 30.         gen p75 = round(p75_un, 1)
 31.         gen diagnosis = "Total"
 32.         order count, first
 33.         order diagnosis, first
 34.         order variable, first
 35.         list variable diagnosis count p50 p25 p75
 36.         keep variable diagnosis count p50 p25 p75
 37.         append using "$projectdir/output/data/table_median_bydiag_rounded.
> dta"
 38.         save "$projectdir/output/data/table_median_bydiag_rounded.dta", re
> place
 39.         restore
 40. } 

     +----------------------------------------------------------+
     |           variable   diagnosis   count   p50   p25   p75 |
     |----------------------------------------------------------|
  1. | time_gp_rheum_appt          RA    3905   223    99   384 |
  2. | time_gp_rheum_appt         PsA    3970   229   100   402 |
  3. | time_gp_rheum_appt       AxSpA    3895   213    93   392 |
  4. | time_gp_rheum_appt   Undiff IA    3720   223   100   400 |
     +----------------------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded.dta saved

     +---------------------------------------------------------+
     |           variable   diagno~s   count   p50   p25   p75 |
     |---------------------------------------------------------|
  1. | time_gp_rheum_appt      Total   15490   222    98   395 |
     +---------------------------------------------------------+
(note: variable diagnosis was str5, now str9 to accommodate using data's
       values)
file /workspace/output/data/table_median_bydiag_rounded.dta saved

     +------------------------------------------------------------+
     |            variable   diagnosis   count   p50   p25    p75 |
     |------------------------------------------------------------|
  1. | time_rheum_eia_code          RA   20665   685   367   1037 |
  2. | time_rheum_eia_code         PsA   20795   687   367   1037 |
  3. | time_rheum_eia_code       AxSpA   20620   690   374   1034 |
  4. | time_rheum_eia_code   Undiff IA   20490   688   366   1041 |
     +------------------------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded.dta saved

     +-----------------------------------------------------------+
     |            variable   diagno~s   count   p50   p25    p75 |
     |-----------------------------------------------------------|
  1. | time_rheum_eia_code      Total   82565   688   368   1037 |
     +-----------------------------------------------------------+
(note: variable diagnosis was str5, now str9 to accommodate using data's
       values)
file /workspace/output/data/table_median_bydiag_rounded.dta saved

. 
. use "$projectdir/output/data/table_median_bydiag_rounded.dta", clear

. export excel "$projectdir/output/tables/table_median_bydiag_rounded.xls", rep
> lace keepcellfmt firstrow(variables)
file /workspace/output/tables/table_median_bydiag_rounded.xls saved

. 
. **All below analyses are for those with rheum appt + GP appt + 6m+ of follow-
> up (changed from 12m requirement, for purposes of OpenSAFELY report)
. 
. **Table of median/IQR outputs - limited to those with 6m follow-up and rheum/
> GP appt
. clear *

. save "$projectdir/output/data/table_median_bydiag_rounded_to21.dta", replace 
> emptyok
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==. //up to April 2022
(37,361 observations deleted)

. 
. foreach var of varlist time_to_csdmard time_gp_rheum_appt time_rheum_eia_code
>  {
  2.         preserve
  3.         collapse (count) "`var'_count"=`var' (p50) p50_un=`var' (p25) p25_
> un=`var' (p75) p75_un=`var', by(eia_diagnosis)
  4.         gen varn = "`var'_count"
  5.         gen variable = substr(varn, 1, strpos(varn, "_count") - 1)
  6.         drop varn
  7.         rename *count freq
  8.         gen count = round(freq, 5)
  9.         gen p50 = round(p50_un, 1)
 10.         gen p25 = round(p25_un, 1)
 11.         gen p75 = round(p75_un, 1)
 12.     decode eia_diagnosis, gen(diagnosis)
 13.         order count, first
 14.         order diagnosis, first
 15.         order variable, first
 16.         list variable diagnosis count p50 p25 p75
 17.         keep variable diagnosis count p50 p25 p75
 18.         append using "$projectdir/output/data/table_median_bydiag_rounded_
> to21.dta"
 19.         save "$projectdir/output/data/table_median_bydiag_rounded_to21.dta
> ", replace
 20.         restore
 21.         preserve
 22.         collapse (count) "`var'_count"=`var' (p50) p50_un=`var' (p25) p25_
> un=`var' (p75) p75_un=`var'
 23.         gen varn = "`var'_count"
 24.         gen variable = substr(varn, 1, strpos(varn, "_count") - 1)
 25.         drop varn
 26.         rename *count freq
 27.         gen count = round(freq, 5)
 28.         gen p50 = round(p50_un, 1)
 29.         gen p25 = round(p25_un, 1)
 30.         gen p75 = round(p75_un, 1)
 31.         gen diagnosis = "Total"
 32.         order count, first
 33.         order diagnosis, first
 34.         order variable, first
 35.         list variable diagnosis count p50 p25 p75
 36.         keep variable diagnosis count p50 p25 p75
 37.         append using "$projectdir/output/data/table_median_bydiag_rounded_
> to21.dta"
 38.         save "$projectdir/output/data/table_median_bydiag_rounded_to21.dta
> ", replace
 39.         restore
 40. } 

     +-------------------------------------------------------+
     |        variable   diagnosis   count   p50   p25   p75 |
     |-------------------------------------------------------|
  1. | time_to_csdmard          RA    1285    64     7   120 |
  2. | time_to_csdmard         PsA    1375    65     9   119 |
  3. | time_to_csdmard       AxSpA    1320    62     3   118 |
  4. | time_to_csdmard   Undiff IA    1305    61     0   117 |
     +-------------------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21.dta saved

     +------------------------------------------------------+
     |        variable   diagno~s   count   p50   p25   p75 |
     |------------------------------------------------------|
  1. | time_to_csdmard      Total    5280    63     5   118 |
     +------------------------------------------------------+
(note: variable diagnosis was str5, now str9 to accommodate using data's
       values)
file /workspace/output/data/table_median_bydiag_rounded_to21.dta saved

     +----------------------------------------------------------+
     |           variable   diagnosis   count   p50   p25   p75 |
     |----------------------------------------------------------|
  1. | time_gp_rheum_appt          RA    2755   292   147   458 |
  2. | time_gp_rheum_appt         PsA    2825   296   154   464 |
  3. | time_gp_rheum_appt       AxSpA    2750   290   140   455 |
  4. | time_gp_rheum_appt   Undiff IA    2675   296   143   465 |
     +----------------------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21.dta saved

     +---------------------------------------------------------+
     |           variable   diagno~s   count   p50   p25   p75 |
     |---------------------------------------------------------|
  1. | time_gp_rheum_appt      Total   11005   294   146   462 |
     +---------------------------------------------------------+
(note: variable diagnosis was str5, now str9 to accommodate using data's
       values)
file /workspace/output/data/table_median_bydiag_rounded_to21.dta saved

     +-----------------------------------------------------------+
     |            variable   diagnosis   count   p50   p25   p75 |
     |-----------------------------------------------------------|
  1. | time_rheum_eia_code          RA    8250   519   234   829 |
  2. | time_rheum_eia_code         PsA    8415   523   230   830 |
  3. | time_rheum_eia_code       AxSpA    8280   514   230   826 |
  4. | time_rheum_eia_code   Undiff IA    8200   517   231   832 |
     +-----------------------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21.dta saved

     +----------------------------------------------------------+
     |            variable   diagno~s   count   p50   p25   p75 |
     |----------------------------------------------------------|
  1. | time_rheum_eia_code      Total   33145   518   231   829 |
     +----------------------------------------------------------+
(note: variable diagnosis was str5, now str9 to accommodate using data's
       values)
file /workspace/output/data/table_median_bydiag_rounded_to21.dta saved

. 
. use "$projectdir/output/data/table_median_bydiag_rounded_to21.dta", clear

. export excel "$projectdir/output/tables/table_median_bydiag_rounded_to21.xls"
> , replace sheet("Overall") keepcellfmt firstrow(variables)
file /workspace/output/tables/table_median_bydiag_rounded_to21.xls saved

. 
. **Table of median/IQR outputs by appt year - limited to those with 6m follow-
> up and rheum/GP appt - tagged to above excel
. 
. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==. 
(37,361 observations deleted)

. 
. recode appt_year 1=2019
(appt_year: 25685 changes made)

. recode appt_year 2=2020
(appt_year: 6363 changes made)

. recode appt_year 3=2021
(appt_year: 1027 changes made)

. recode appt_year 4=2022
(appt_year: 69 changes made)

. 
. local index=0

. levelsof appt_year, local(levels)
2019 2020 2021 2022

. foreach i of local levels {
  2.         clear *
  3.         save "$projectdir/output/data/table_median_bydiag_rounded_to21_`i'
> .dta", replace emptyok
  4. di `index'
  5.         if `index'==0 {
  6.                 local col = word("`c(ALPHA)'", `index'+7)
  7.         }
  8.         else if `index'>0 & `index'<=21 {
  9.             local col = word("`c(ALPHA)'", `index'+5)
 10.         }
 11.         di "`col'"
 12.         if `index'==0 {
 13.                 local `index++'
 14.                 local `index++'
 15.                 local `index++'
 16.                 local `index++'
 17.                 local `index++'
 18.                 local `index++'
 19.         }
 20.         else {
 21.             local `index++'
 22.                 local `index++'
 23.                 local `index++'
 24.                 local `index++'
 25.         }
 26.         di `index'
 27. 
. use "$projectdir/output/data/file_eia_all.dta", clear
 28. 
. keep if has_6m_post_appt==1
 29. drop if appt_year>4 | appt_year==. 
 30. 
. recode appt_year 1=2019
 31. recode appt_year 2=2020
 32. recode appt_year 3=2021
 33. recode appt_year 4=2022
 34. 
. keep if appt_year==`i'
 35. 
. foreach var of varlist time_to_csdmard time_gp_rheum_appt time_rheum_eia_code
>  {
 36.         preserve
 37.         collapse (count) freq=`var' (p50) p50_un=`var' (p25) p25_un=`var' 
> (p75) p75_un=`var', by(eia_diagnosis)
 38.         gen count = round(freq, 5)
 39.         gen p50 = round(p50_un, 1)
 40.         gen p25 = round(p25_un, 1)
 41.         gen p75 = round(p75_un, 1)
 42.         drop p50_un p25_un p75_un
 43.         rename count count_`i'
 44.         rename p50 p50_`i'
 45.         rename p25 p25_`i'
 46.         rename p75 p75_`i'
 47.         order count, first
 48.         list count p50 p25 p75
 49.         keep count p50 p25 p75
 50.         append using "$projectdir/output/data/table_median_bydiag_rounded_
> to21_`i'.dta"
 51.         save "$projectdir/output/data/table_median_bydiag_rounded_to21_`i'
> .dta", replace
 52.         restore
 53.                 preserve
 54.         collapse (count) freq=`var' (p50) p50_un=`var' (p25) p25_un=`var' 
> (p75) p75_un=`var'
 55.         gen count = round(freq, 5)
 56.         gen p50 = round(p50_un, 1)
 57.         gen p25 = round(p25_un, 1)
 58.         gen p75 = round(p75_un, 1)
 59.         drop p50_un p25_un p75_un
 60.         rename count count_`i'
 61.         rename p50 p50_`i'
 62.         rename p25 p25_`i'
 63.         rename p75 p75_`i'
 64.         order count, first
 65.         list count p50 p25 p75
 66.         keep count p50 p25 p75
 67.         append using "$projectdir/output/data/table_median_bydiag_rounded_
> to21_`i'.dta"
 68.         save "$projectdir/output/data/table_median_bydiag_rounded_to21_`i'
> .dta", replace
 69.         restore
 70. } 
 71. 
. display `index'
 72. display "`col'"
 73. use "$projectdir/output/data/table_median_bydiag_rounded_to21_`i'.dta", cl
> ear
 74. export excel "$projectdir/output/tables/table_median_bydiag_rounded_to21.x
> ls", sheet("Overall", modify) cell("`col'1") keepcellfmt firstrow(variables)
 75. }
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_2019.dta saved
0
G
6
(103,305 observations deleted)
(37,361 observations deleted)
(appt_year: 25685 changes made)
(appt_year: 6363 changes made)
(appt_year: 1027 changes made)
(appt_year: 69 changes made)
(7,459 observations deleted)

     +-------------------------------------------+
     | cou~2019   p50_2019   p25_2019   p75_2019 |
     |-------------------------------------------|
  1. |      985         63          5        120 |
  2. |     1035         65         10        119 |
  3. |      985         63          5        118 |
  4. |     1000         63          3        116 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2019.dta saved

     +-------------------------------------------+
     | cou~2019   p50_2019   p25_2019   p75_2019 |
     |-------------------------------------------|
  1. |     4000         63          6        118 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2019.dta saved

     +-------------------------------------------+
     | cou~2019   p50_2019   p25_2019   p75_2019 |
     |-------------------------------------------|
  1. |     1805        250        123        368 |
  2. |     1820        253        129        375 |
  3. |     1770        242        119        367 |
  4. |     1745        247        122        373 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2019.dta saved

     +-------------------------------------------+
     | cou~2019   p50_2019   p25_2019   p75_2019 |
     |-------------------------------------------|
  1. |     7140        249        123        370 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2019.dta saved

     +-------------------------------------------+
     | cou~2019   p50_2019   p25_2019   p75_2019 |
     |-------------------------------------------|
  1. |     6410        579        269        901 |
  2. |     6500        587        264        903 |
  3. |     6435        579        269        896 |
  4. |     6345        581        274        906 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2019.dta saved

     +-------------------------------------------+
     | cou~2019   p50_2019   p25_2019   p75_2019 |
     |-------------------------------------------|
  1. |    25685        581        268        901 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2019.dta saved
6
G
file /workspace/output/tables/table_median_bydiag_rounded_to21.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_2020.dta saved
6
K
10
(103,305 observations deleted)
(37,361 observations deleted)
(appt_year: 25685 changes made)
(appt_year: 6363 changes made)
(appt_year: 1027 changes made)
(appt_year: 69 changes made)
(26,781 observations deleted)

     +-------------------------------------------+
     | cou~2020   p50_2020   p25_2020   p75_2020 |
     |-------------------------------------------|
  1. |      260         66         12        121 |
  2. |      280         58         -4        116 |
  3. |      285         62         -4        122 |
  4. |      255         58        -11        117 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2020.dta saved

     +-------------------------------------------+
     | cou~2020   p50_2020   p25_2020   p75_2020 |
     |-------------------------------------------|
  1. |     1080         60         -2        119 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2020.dta saved

     +-------------------------------------------+
     | cou~2020   p50_2020   p25_2020   p75_2020 |
     |-------------------------------------------|
  1. |      760        429        228        650 |
  2. |      780        423        201        626 |
  3. |      795        425        211        628 |
  4. |      755        421        215        634 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2020.dta saved

     +-------------------------------------------+
     | cou~2020   p50_2020   p25_2020   p75_2020 |
     |-------------------------------------------|
  1. |     3095        425        214        635 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2020.dta saved

     +-------------------------------------------+
     | cou~2020   p50_2020   p25_2020   p75_2020 |
     |-------------------------------------------|
  1. |     1585        406        179        641 |
  2. |     1610        412        186        638 |
  3. |     1580        390        161        617 |
  4. |     1590        397        171        629 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2020.dta saved

     +-------------------------------------------+
     | cou~2020   p50_2020   p25_2020   p75_2020 |
     |-------------------------------------------|
  1. |     6365        400        173        632 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2020.dta saved
10
K
file /workspace/output/tables/table_median_bydiag_rounded_to21.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_2021.dta saved
10
O
14
(103,305 observations deleted)
(37,361 observations deleted)
(appt_year: 25685 changes made)
(appt_year: 6363 changes made)
(appt_year: 1027 changes made)
(appt_year: 69 changes made)
(32,117 observations deleted)

     +-------------------------------------------+
     | cou~2021   p50_2021   p25_2021   p75_2021 |
     |-------------------------------------------|
  1. |       35         89         30        115 |
  2. |       55         87         47        110 |
  3. |       50         49         -5        120 |
  4. |       45         52          7        136 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2021.dta saved

     +-------------------------------------------+
     | cou~2021   p50_2021   p25_2021   p75_2021 |
     |-------------------------------------------|
  1. |      185         71         14        116 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2021.dta saved

     +-------------------------------------------+
     | cou~2021   p50_2021   p25_2021   p75_2021 |
     |-------------------------------------------|
  1. |      175        531        291        897 |
  2. |      210        640        342        944 |
  3. |      165        575        248        890 |
  4. |      160        609        355        893 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2021.dta saved

     +-------------------------------------------+
     | cou~2021   p50_2021   p25_2021   p75_2021 |
     |-------------------------------------------|
  1. |      705        593        294        901 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2021.dta saved

     +-------------------------------------------+
     | cou~2021   p50_2021   p25_2021   p75_2021 |
     |-------------------------------------------|
  1. |      240        214         70        340 |
  2. |      295        224         83        360 |
  3. |      245        205         55        346 |
  4. |      250        241         89        393 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2021.dta saved

     +-------------------------------------------+
     | cou~2021   p50_2021   p25_2021   p75_2021 |
     |-------------------------------------------|
  1. |     1025        223         70        360 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2021.dta saved
14
O
file /workspace/output/tables/table_median_bydiag_rounded_to21.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_2022.dta saved
14
S
18
(103,305 observations deleted)
(37,361 observations deleted)
(appt_year: 25685 changes made)
(appt_year: 6363 changes made)
(appt_year: 1027 changes made)
(appt_year: 69 changes made)
(33,075 observations deleted)

     +-------------------------------------------+
     | cou~2022   p50_2022   p25_2022   p75_2022 |
     |-------------------------------------------|
  1. |        5         68          7        146 |
  2. |        5         75         44        104 |
  3. |        5         67          9        148 |
  4. |        5         54         44        166 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2022.dta saved

     +-------------------------------------------+
     | cou~2022   p50_2022   p25_2022   p75_2022 |
     |-------------------------------------------|
  1. |       15         62         32        116 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2022.dta saved

     +-------------------------------------------+
     | cou~2022   p50_2022   p25_2022   p75_2022 |
     |-------------------------------------------|
  1. |       15        908        145       1231 |
  2. |       15        993        750       1189 |
  3. |       15        704        469        905 |
  4. |       15        804        304        997 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2022.dta saved

     +-------------------------------------------+
     | cou~2022   p50_2022   p25_2022   p75_2022 |
     |-------------------------------------------|
  1. |       60        813        340       1000 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2022.dta saved

     +-------------------------------------------+
     | cou~2022   p50_2022   p25_2022   p75_2022 |
     |-------------------------------------------|
  1. |       15         77        -13        168 |
  2. |       15         78         14        135 |
  3. |       20        109         15        156 |
  4. |       20         67        -22        110 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2022.dta saved

     +-------------------------------------------+
     | cou~2022   p50_2022   p25_2022   p75_2022 |
     |-------------------------------------------|
  1. |       70         76          6        150 |
     +-------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_2022.dta saved
18
S
file /workspace/output/tables/table_median_bydiag_rounded_to21.xls saved

. 
. **Table of median/IQR outputs - for OpenSAFELY Report (3 monthly periods) - l
> imited to those with 6m follow-up and rheum/GP appt
. clear *

. save "$projectdir/output/data/table_median_bydiag_rounded_to21_report.dta", r
> eplace emptyok
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==. 
(37,361 observations deleted)

. 
. foreach var of varlist time_gp_rheum_appt {
  2.         preserve
  3.         collapse (count) "`var'_count"=`var' (p50) p50_un=`var', by(eia_di
> agnosis)
  4.         gen varn = "`var'_count"
  5.         gen variable = substr(varn, 1, strpos(varn, "_count") - 1)
  6.         drop varn
  7.         rename *count freq
  8.         gen count_all = round(freq, 5)
  9.         gen p50_all = round(p50_un, 1)
 10.     decode eia_diagnosis, gen(diagnosis)
 11.         order count, first
 12.         order diagnosis, first
 13.         order variable, first
 14.         list variable diagnosis count_all p50_all
 15.         keep variable diagnosis count_all p50_all
 16.         append using "$projectdir/output/data/table_median_bydiag_rounded_
> to21_report.dta"
 17.         save "$projectdir/output/data/table_median_bydiag_rounded_to21_rep
> ort.dta", replace
 18.         restore
 19.         preserve
 20.         collapse (count) "`var'_count"=`var' (p50) p50_un=`var'
 21.         gen varn = "`var'_count"
 22.         gen variable = substr(varn, 1, strpos(varn, "_count") - 1)
 23.         drop varn
 24.         rename *count freq
 25.         gen count_all = round(freq, 5)
 26.         gen p50_all = round(p50_un, 1)
 27.         gen diagnosis = "Total"
 28.         order count, first
 29.         order diagnosis, first
 30.         order variable, first
 31.         list variable diagnosis count_all p50_all
 32.         keep variable diagnosis count_all p50_all
 33.         append using "$projectdir/output/data/table_median_bydiag_rounded_
> to21_report.dta"
 34.         save "$projectdir/output/data/table_median_bydiag_rounded_to21_rep
> ort.dta", replace
 35.         restore
 36. } 

     +-----------------------------------------------------+
     |           variable   diagnosis   count_~l   p50_all |
     |-----------------------------------------------------|
  1. | time_gp_rheum_appt          RA       2755       292 |
  2. | time_gp_rheum_appt         PsA       2825       296 |
  3. | time_gp_rheum_appt       AxSpA       2750       290 |
  4. | time_gp_rheum_appt   Undiff IA       2675       296 |
     +-----------------------------------------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report.dta saved

     +----------------------------------------------------+
     |           variable   diagno~s   count_~l   p50_all |
     |----------------------------------------------------|
  1. | time_gp_rheum_appt      Total      11005       294 |
     +----------------------------------------------------+
(note: variable diagnosis was str5, now str9 to accommodate using data's
       values)
file /workspace/output/data/table_median_bydiag_rounded_to21_report.dta saved

. 
. use "$projectdir/output/data/table_median_bydiag_rounded_to21_report.dta", cl
> ear

. export excel "$projectdir/output/tables/table_median_bydiag_rounded_to21_repo
> rt.xls", replace sheet("Overall") keepcellfmt firstrow(variables)
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved

. 
. **Table of median/IQR outputs by appt year - for OpenSAFELY Report - limited 
> to those with 6m follow-up and rheum/GP appt - tagged to above excel
. 
. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==. 
(37,361 observations deleted)

. 
. local index=0

. levelsof appt_3m, local(levels)
1 2 3 4 5 6 7 8 9 10 11 12 13

. foreach i of local levels {
  2.         clear *
  3.         save "$projectdir/output/data/table_median_bydiag_rounded_to21_rep
> ort_`i'.dta", replace emptyok
  4. di `index'
  5.         if `index'==0 {
  6.                 local col = word("`c(ALPHA)'", `index'+5)
  7.         }
  8.         else if `index'>0 & `index'<=21 {
  9.             local col = word("`c(ALPHA)'", `index'+3)
 10.         }
 11.         else if `index'==22 {
 12.             local col = "Y"
 13.         }
 14.         else if `index'==24 {
 15.             local col = "AA"
 16.         }
 17.         else if `index'==26 {
 18.             local col = "AC"
 19.         }       
 20.         di "`col'"
 21.         if `index'==0 {
 22.                 local `index++'
 23.                 local `index++'
 24.                 local `index++'
 25.                 local `index++'
 26.         }
 27.         else {
 28.             local `index++'
 29.                 local `index++'
 30.         }
 31.         di `index'
 32. 
. use "$projectdir/output/data/file_eia_all.dta", clear
 33. 
. keep if has_6m_post_appt==1
 34. drop if appt_year>4 | appt_year==. 
 35. keep if appt_3m==`i'
 36. 
. foreach var of varlist time_gp_rheum_appt {
 37.         preserve
 38.         collapse (count) freq=`var' (p50) p50_un=`var', by(eia_diagnosis)
 39.         gen count = round(freq, 5)
 40.         gen p50 = round(p50_un, 1)
 41.         drop p50_un
 42.         rename count count_period`i'
 43.         rename p50 p50_period`i'
 44.         order count, first
 45.         list count p50
 46.         keep count p50
 47.         append using "$projectdir/output/data/table_median_bydiag_rounded_
> to21_report_`i'.dta"
 48.         save "$projectdir/output/data/table_median_bydiag_rounded_to21_rep
> ort_`i'.dta", replace
 49.         restore
 50.                 preserve
 51.         collapse (count) freq=`var' (p50) p50_un=`var'
 52.         gen count = round(freq, 5)
 53.         gen p50 = round(p50_un, 1)
 54.         drop p50_un
 55.         rename count count_period`i'
 56.         rename p50 p50_period`i'
 57.         order count, first
 58.         list count p50
 59.         keep count p50
 60.         append using "$projectdir/output/data/table_median_bydiag_rounded_
> to21_report_`i'.dta"
 61.         save "$projectdir/output/data/table_median_bydiag_rounded_to21_rep
> ort_`i'.dta", replace
 62.         restore
 63. } 
 64. 
. display `index'
 65. display "`col'"
 66. use "$projectdir/output/data/table_median_bydiag_rounded_to21_report_`i'.d
> ta", clear
 67. export excel "$projectdir/output/tables/table_median_bydiag_rounded_to21_r
> eport.xls", sheet("Overall", modify) cell("`col'1") keepcellfmt firstrow(vari
> ables)
 68. }
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_1.dta saved
0
E
4
(103,305 observations deleted)
(37,361 observations deleted)
(23,649 observations deleted)

     +---------------------+
     | count_~1   p50_pe~1 |
     |---------------------|
  1. |      545        200 |
  2. |      535        207 |
  3. |      515        190 |
  4. |      475        191 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_1.dta saved

     +---------------------+
     | count_~1   p50_pe~1 |
     |---------------------|
  1. |     2070        198 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_1.dta saved
4
E
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_2.dta saved
4
G
6
(103,305 observations deleted)
(37,361 observations deleted)
(25,622 observations deleted)

     +---------------------+
     | count_~2   p50_pe~2 |
     |---------------------|
  1. |      530        240 |
  2. |      540        247 |
  3. |      530        236 |
  4. |      460        241 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_2.dta saved

     +---------------------+
     | count_~2   p50_pe~2 |
     |---------------------|
  1. |     2065        241 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_2.dta saved
6
G
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_3.dta saved
6
I
8
(103,305 observations deleted)
(37,361 observations deleted)
(28,005 observations deleted)

     +---------------------+
     | count_~3   p50_pe~3 |
     |---------------------|
  1. |      405        292 |
  2. |      405        288 |
  3. |      400        287 |
  4. |      465        285 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_3.dta saved

     +---------------------+
     | count_~3   p50_pe~3 |
     |---------------------|
  1. |     1675        288 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_3.dta saved
8
I
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_4.dta saved
8
K
10
(103,305 observations deleted)
(37,361 observations deleted)
(29,615 observations deleted)

     +---------------------+
     | count_~4   p50_pe~4 |
     |---------------------|
  1. |      320        329 |
  2. |      340        349 |
  3. |      325        323 |
  4. |      345        322 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_4.dta saved

     +---------------------+
     | count_~4   p50_pe~4 |
     |---------------------|
  1. |     1330        329 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_4.dta saved
10
K
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_5.dta saved
10
M
12
(103,305 observations deleted)
(37,361 observations deleted)
(30,504 observations deleted)

     +---------------------+
     | count_~5   p50_pe~5 |
     |---------------------|
  1. |      290        391 |
  2. |      310        360 |
  3. |      310        407 |
  4. |      260        379 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_5.dta saved

     +---------------------+
     | count_~5   p50_pe~5 |
     |---------------------|
  1. |     1175        384 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_5.dta saved
12
M
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_6.dta saved
12
O
14
(103,305 observations deleted)
(37,361 observations deleted)
(31,360 observations deleted)

     +---------------------+
     | count_~6   p50_pe~6 |
     |---------------------|
  1. |      220        407 |
  2. |      190        429 |
  3. |      210        396 |
  4. |      230        422 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_6.dta saved

     +---------------------+
     | count_~6   p50_pe~6 |
     |---------------------|
  1. |      850        414 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_6.dta saved
14
O
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_7.dta saved
14
Q
16
(103,305 observations deleted)
(37,361 observations deleted)
(31,964 observations deleted)

     +---------------------+
     | count_~7   p50_pe~7 |
     |---------------------|
  1. |      145        525 |
  2. |      180        474 |
  3. |      165        491 |
  4. |      160        475 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_7.dta saved

     +---------------------+
     | count_~7   p50_pe~7 |
     |---------------------|
  1. |      650        489 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_7.dta saved
16
Q
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_8.dta saved
16
S
18
(103,305 observations deleted)
(37,361 observations deleted)
(32,385 observations deleted)

     +---------------------+
     | count_~8   p50_pe~8 |
     |---------------------|
  1. |      110        542 |
  2. |      100        531 |
  3. |      110        465 |
  4. |      100        458 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_8.dta saved

     +---------------------+
     | count_~8   p50_pe~8 |
     |---------------------|
  1. |      420        498 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_8.dta saved
18
S
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_9.dta saved
18
U
20
(103,305 observations deleted)
(37,361 observations deleted)
(32,664 observations deleted)

     +---------------------+
     | count_~9   p50_pe~9 |
     |---------------------|
  1. |       80        520 |
  2. |       90        664 |
  3. |       65        411 |
  4. |       80        590 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_9.dta saved

     +---------------------+
     | count_~9   p50_pe~9 |
     |---------------------|
  1. |      315        583 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_9.dta saved
20
U
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_10.dta save
> d
20
W
22
(103,305 observations deleted)
(37,361 observations deleted)
(32,857 observations deleted)

     +---------------------+
     | count~10   p50_p~10 |
     |---------------------|
  1. |       50        609 |
  2. |       55        638 |
  3. |       45        746 |
  4. |       35        539 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_10.dta save
> d

     +---------------------+
     | count~10   p50_p~10 |
     |---------------------|
  1. |      185        639 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_10.dta save
> d
22
W
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_11.dta save
> d
22
Y
24
(103,305 observations deleted)
(37,361 observations deleted)
(32,975 observations deleted)

     +---------------------+
     | count~11   p50_p~11 |
     |---------------------|
  1. |       30        429 |
  2. |       45        624 |
  3. |       35        554 |
  4. |       25        628 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_11.dta save
> d

     +---------------------+
     | count~11   p50_p~11 |
     |---------------------|
  1. |      130        581 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_11.dta save
> d
24
Y
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_12.dta save
> d
24
AA
26
(103,305 observations deleted)
(37,361 observations deleted)
(33,053 observations deleted)

     +---------------------+
     | count~12   p50_p~12 |
     |---------------------|
  1. |       15        782 |
  2. |       20        381 |
  3. |       20        645 |
  4. |       20        815 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_12.dta save
> d

     +---------------------+
     | count~12   p50_p~12 |
     |---------------------|
  1. |       75        744 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_12.dta save
> d
26
AA
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/table_median_bydiag_rounded_to21_report_13.dta save
> d
26
AC
28
(103,305 observations deleted)
(37,361 observations deleted)
(33,075 observations deleted)

     +---------------------+
     | count~13   p50_p~13 |
     |---------------------|
  1. |       15        908 |
  2. |       15        993 |
  3. |       15        704 |
  4. |       15        804 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_13.dta save
> d

     +---------------------+
     | count~13   p50_p~13 |
     |---------------------|
  1. |       60        813 |
     +---------------------+
file /workspace/output/data/table_median_bydiag_rounded_to21_report_13.dta save
> d
28
AC
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.xls saved

. 
. **ITSA outputs for appt delays - 6m+ only
. clear *

. save "$projectdir/output/data/ITSA_tables_rounded.dta", replace emptyok
(note: dataset contains 0 observations)
file /workspace/output/data/ITSA_tables_rounded.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==. 
(37,361 observations deleted)

. 
. recode gp_appt_3w 2=0
(gp_appt_3w: 10586 changes made)

. lab var gp_appt_3w "Rheum appt within 3 weeks"

. lab def gp_appt_3w 0 "No" 1 "Yes", modify

. lab val gp_appt_3w gp_appt_3w

. 
. foreach var of varlist gp_appt_3w {
  2.         preserve
  3.         collapse (count) "`var'_count"=`var' (mean) mean=`var', by(mo_year
> _appt_s)
  4.         gen varn = "`var'_count"
  5.         gen variable = substr(varn, 1, strpos(varn, "_count") - 1)
  6.         drop varn
  7.         rename *count freq
  8.         gen count = round(freq, 5)
  9.         gen countstr = string(count)
 10.         replace countstr = "<8" if count<=7
 11.         order countstr, after(count)
 12.         drop count
 13.         rename countstr count
 14.         tostring mean, gen(meanstr) force format(%9.3f)
 15.         replace meanstr = "-" if count =="<8"
 16.         order meanstr, after(mean)
 17.         drop mean
 18.         rename meanstr mean_proportion
 19.         order count, first
 20.         order mo_year_appt_s, first
 21.         order variable, first
 22.         list variable mo_year_appt_s count mean_proportion 
 23.         keep variable mo_year_appt_s count mean_proportion 
 24.         append using "$projectdir/output/data/ITSA_tables_rounded.dta"
 25.         save "$projectdir/output/data/ITSA_tables_rounded.dta", replace
 26.         restore
 27.         preserve
 28.         collapse (count) "`var'_count"=`var' (mean) mean=`var'
 29.         gen varn = "`var'_count"
 30.         gen variable = substr(varn, 1, strpos(varn, "_count") - 1)
 31.         drop varn
 32.         rename *count freq
 33.         gen count = round(freq, 5)
 34.         gen countstr = string(count)
 35.         replace countstr = "<8" if count<=7
 36.         order countstr, after(count)
 37.         drop count
 38.         rename countstr count
 39.         tostring mean, gen(meanstr) force format(%9.3f)
 40.         replace meanstr = "-" if count =="<8"
 41.         order meanstr, after(mean)
 42.         drop mean
 43.         rename meanstr mean_proportion
 44.         gen mo_year_appt_s = "Overall"
 45.         order count, first
 46.         order mo_year_appt_s, first
 47.         order variable, first
 48.         list variable mo_year_appt_s count mean_proportion 
 49.         keep variable mo_year_appt_s count mean_proportion 
 50.         append using "$projectdir/output/data/ITSA_tables_rounded.dta"
 51.         save "$projectdir/output/data/ITSA_tables_rounded.dta", replace
 52.         restore
 53. } 
(0 real changes made)
meanstr generated as str5
meanstr was forced to string; some loss of information
(0 real changes made)

     +------------------------------------------+
     |   variable   mo_yea~s   count   mean_p~n |
     |------------------------------------------|
  1. | gp_appt_3w    2019m04     625      0.055 |
  2. | gp_appt_3w    2019m05     710      0.059 |
  3. | gp_appt_3w    2019m06     740      0.057 |
  4. | gp_appt_3w    2019m07     735      0.046 |
  5. | gp_appt_3w    2019m08     695      0.037 |
     |------------------------------------------|
  6. | gp_appt_3w    2019m09     635      0.046 |
  7. | gp_appt_3w    2019m10     595      0.050 |
  8. | gp_appt_3w    2019m11     540      0.037 |
  9. | gp_appt_3w    2019m12     535      0.026 |
 10. | gp_appt_3w    2020m01     525      0.040 |
     |------------------------------------------|
 11. | gp_appt_3w    2020m02     420      0.033 |
 12. | gp_appt_3w    2020m03     385      0.029 |
 13. | gp_appt_3w    2020m04     435      0.048 |
 14. | gp_appt_3w    2020m05     400      0.030 |
 15. | gp_appt_3w    2020m06     340      0.033 |
     |------------------------------------------|
 16. | gp_appt_3w    2020m07     325      0.034 |
 17. | gp_appt_3w    2020m08     295      0.020 |
 18. | gp_appt_3w    2020m09     230      0.018 |
 19. | gp_appt_3w    2020m10     240      0.017 |
 20. | gp_appt_3w    2020m11     205      0.010 |
     |------------------------------------------|
 21. | gp_appt_3w    2020m12     205      0.019 |
 22. | gp_appt_3w    2021m01     150      0.013 |
 23. | gp_appt_3w    2021m02     150      0.027 |
 24. | gp_appt_3w    2021m03     120      0.041 |
 25. | gp_appt_3w    2021m04     125      0.016 |
     |------------------------------------------|
 26. | gp_appt_3w    2021m05     105      0.037 |
 27. | gp_appt_3w    2021m06      85      0.000 |
 28. | gp_appt_3w    2021m07      70      0.014 |
 29. | gp_appt_3w    2021m08      55      0.000 |
 30. | gp_appt_3w    2021m09      60      0.033 |
     |------------------------------------------|
 31. | gp_appt_3w    2021m10      55      0.019 |
 32. | gp_appt_3w    2021m11      40      0.000 |
 33. | gp_appt_3w    2021m12      35      0.000 |
 34. | gp_appt_3w    2022m01      25      0.038 |
 35. | gp_appt_3w    2022m02      25      0.042 |
     |------------------------------------------|
 36. | gp_appt_3w    2022m03      25      0.000 |
 37. | gp_appt_3w    2022m04      25      0.038 |
 38. | gp_appt_3w    2022m05      20      0.000 |
 39. | gp_appt_3w    2022m06      15      0.071 |
     +------------------------------------------+
file /workspace/output/data/ITSA_tables_rounded.dta saved
(0 real changes made)
meanstr generated as str5
meanstr was forced to string; some loss of information
(0 real changes made)

     +------------------------------------------+
     |   variable   mo_yea~s   count   mean_p~n |
     |------------------------------------------|
  1. | gp_appt_3w    Overall   11005      0.038 |
     +------------------------------------------+
(note: variable mo_year_appt_s was str7, now str16 to accommodate using
       data's values)
file /workspace/output/data/ITSA_tables_rounded.dta saved

. 
. use "$projectdir/output/data/ITSA_tables_rounded.dta", clear

. export excel "$projectdir/output/tables/ITSA_tables_appt_delay_rounded.xls", 
> replace sheet ("GP to Appt") keepcellfmt firstrow(variables)
file /workspace/output/tables/ITSA_tables_appt_delay_rounded.xls saved

. 
. **ITSA outputs for csDMARDs - 6m+ only
. clear *

. save "$projectdir/output/data/ITSA_tables_rounded.dta", replace emptyok
(note: dataset contains 0 observations)
file /workspace/output/data/ITSA_tables_rounded.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==. 
(37,361 observations deleted)

. keep if ra_code==1 | psa_code==1 | undiff_code==1
(8,278 observations deleted)

. 
. foreach var of varlist csdmard_6m {
  2.         preserve
  3.         collapse (count) "`var'_count"=`var' (mean) mean=`var', by(mo_year
> _appt_s)
  4.         gen varn = "`var'_count"
  5.         gen variable = substr(varn, 1, strpos(varn, "_count") - 1)
  6.         drop varn
  7.         rename *count freq
  8.         gen count = round(freq, 5)
  9.         gen countstr = string(count)
 10.         replace countstr = "<8" if count<=7
 11.         order countstr, after(count)
 12.         drop count
 13.         rename countstr count
 14.         tostring mean, gen(meanstr) force format(%9.3f)
 15.         replace meanstr = "-" if count =="<8"
 16.         order meanstr, after(mean)
 17.         drop mean
 18.         rename meanstr mean_proportion
 19.         order count, first
 20.         order mo_year_appt_s, first
 21.         order variable, first
 22.         list variable mo_year_appt_s count mean_proportion 
 23.         keep variable mo_year_appt_s count mean_proportion 
 24.         append using "$projectdir/output/data/ITSA_tables_rounded.dta"
 25.         save "$projectdir/output/data/ITSA_tables_rounded.dta", replace
 26.         restore
 27.         preserve
 28.         collapse (count) "`var'_count"=`var' (mean) mean=`var'
 29.         gen varn = "`var'_count"
 30.         gen variable = substr(varn, 1, strpos(varn, "_count") - 1)
 31.         drop varn
 32.         rename *count freq
 33.         gen count = round(freq, 5)
 34.         gen countstr = string(count)
 35.         replace countstr = "<8" if count<=7
 36.         order countstr, after(count)
 37.         drop count
 38.         rename countstr count
 39.         tostring mean, gen(meanstr) force format(%9.3f)
 40.         replace meanstr = "-" if count =="<8"
 41.         order meanstr, after(mean)
 42.         drop mean
 43.         rename meanstr mean_proportion
 44.         gen mo_year_appt_s = "Overall"
 45.         order count, first
 46.         order mo_year_appt_s, first
 47.         order variable, first
 48.         list variable mo_year_appt_s count mean_proportion 
 49.         keep variable mo_year_appt_s count mean_proportion 
 50.         append using "$projectdir/output/data/ITSA_tables_rounded.dta"
 51.         save "$projectdir/output/data/ITSA_tables_rounded.dta", replace
 52.         restore
 53. } 
(0 real changes made)
meanstr generated as str5
meanstr was forced to string; some loss of information
(0 real changes made)

     +------------------------------------------+
     |   variable   mo_yea~s   count   mean_p~n |
     |------------------------------------------|
  1. | csdmard_6m    2019m04    2375      0.121 |
  2. | csdmard_6m    2019m05    2390      0.146 |
  3. | csdmard_6m    2019m06    2315      0.174 |
  4. | csdmard_6m    2019m07    2130      0.168 |
  5. | csdmard_6m    2019m08    1935      0.136 |
     |------------------------------------------|
  6. | csdmard_6m    2019m09    1570      0.178 |
  7. | csdmard_6m    2019m10    1480      0.168 |
  8. | csdmard_6m    2019m11    1240      0.167 |
  9. | csdmard_6m    2019m12    1185      0.146 |
 10. | csdmard_6m    2020m01    1030      0.172 |
     |------------------------------------------|
 11. | csdmard_6m    2020m02     845      0.150 |
 12. | csdmard_6m    2020m03     760      0.193 |
 13. | csdmard_6m    2020m04     750      0.181 |
 14. | csdmard_6m    2020m05     675      0.175 |
 15. | csdmard_6m    2020m06     545      0.169 |
     |------------------------------------------|
 16. | csdmard_6m    2020m07     525      0.165 |
 17. | csdmard_6m    2020m08     450      0.161 |
 18. | csdmard_6m    2020m09     385      0.178 |
 19. | csdmard_6m    2020m10     320      0.146 |
 20. | csdmard_6m    2020m11     285      0.133 |
     |------------------------------------------|
 21. | csdmard_6m    2020m12     275      0.193 |
 22. | csdmard_6m    2021m01     200      0.129 |
 23. | csdmard_6m    2021m02     205      0.151 |
 24. | csdmard_6m    2021m03     165      0.175 |
 25. | csdmard_6m    2021m04     145      0.190 |
     |------------------------------------------|
 26. | csdmard_6m    2021m05     125      0.153 |
 27. | csdmard_6m    2021m06     105      0.124 |
 28. | csdmard_6m    2021m07      85      0.174 |
 29. | csdmard_6m    2021m08      60      0.207 |
 30. | csdmard_6m    2021m09      65      0.197 |
     |------------------------------------------|
 31. | csdmard_6m    2021m10      55      0.127 |
 32. | csdmard_6m    2021m11      40      0.286 |
 33. | csdmard_6m    2021m12      30      0.156 |
 34. | csdmard_6m    2022m01      20      0.182 |
 35. | csdmard_6m    2022m02      25      0.208 |
     |------------------------------------------|
 36. | csdmard_6m    2022m03      20      0.182 |
 37. | csdmard_6m    2022m04      20      0.211 |
 38. | csdmard_6m    2022m05      15      0.250 |
 39. | csdmard_6m    2022m06      15      0.143 |
     +------------------------------------------+
file /workspace/output/data/ITSA_tables_rounded.dta saved
(0 real changes made)
meanstr generated as str5
meanstr was forced to string; some loss of information
(0 real changes made)

     +------------------------------------------+
     |   variable   mo_yea~s   count   mean_p~n |
     |------------------------------------------|
  1. | csdmard_6m    Overall   24865      0.159 |
     +------------------------------------------+
(note: variable mo_year_appt_s was str7, now str16 to accommodate using
       data's values)
file /workspace/output/data/ITSA_tables_rounded.dta saved

. 
. use "$projectdir/output/data/ITSA_tables_rounded.dta", clear

. export excel "$projectdir/output/tables/ITSA_tables_csdmard_delay_rounded.xls
> ", replace sheet("csDMARD delays") keepcellfmt firstrow(variables)
file /workspace/output/tables/ITSA_tables_csdmard_delay_rounded.xls saved

. 
. **csDMARD table for all EIA patients
. clear *

. save "$projectdir/output/data/drug_byyearanddisease_all.dta", replace emptyok
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearanddisease_all.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==. 
(37,361 observations deleted)

. keep if ra_code==1 | psa_code==1 | undiff_code==1
(8,278 observations deleted)

. 
. foreach var of varlist csdmard_time_22 csdmard_time_21 csdmard_time_20 csdmar
> d_time_19 hcq_time ssz_time mtx_time csdmard_time {
  2.         preserve
  3.         contract `var'
  4.         local v : variable label `var' 
  5.         gen variable = `"`v'"'
  6.     decode `var', gen(categories)
  7.         gen count = round(_freq, 5)
  8.         egen total = total(count)
  9.         gen percent = round((count/total)*100, 0.1)
 10.         order total, after(percent)
 11.         gen countstr = string(count)
 12.         replace countstr = "<8" if count<=7
 13.         order countstr, after(count)
 14.         drop count
 15.         rename countstr count_all
 16.         tostring percent, gen(percentstr) force format(%9.1f)
 17.         replace percentstr = "-" if count =="<8"
 18.         order percentstr, after(percent)
 19.         drop percent
 20.         rename percentstr percent_all
 21.         gen totalstr = string(total)
 22.         replace totalstr = "-" if count =="<8"
 23.         order totalstr, after(total)
 24.         drop total
 25.         rename totalstr total_all
 26.         list variable categories count percent total
 27.         keep variable categories count percent total
 28.         append using "$projectdir/output/data/drug_byyearanddisease_all.dt
> a"
 29.         save "$projectdir/output/data/drug_byyearanddisease_all.dta", repl
> ace
 30.         restore
 31. }
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)

     +------------------------------------------------------------------+
  1. |                                            variable              |
     |              csDMARD in primary care, Apr 2022-2023              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                 Within 3 months |       <8 |        - |        - |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  2. |                                            variable              |
     |              csDMARD in primary care, Apr 2022-2023              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                      3-6 months |       <8 |        - |        - |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  3. |                                            variable              |
     |              csDMARD in primary care, Apr 2022-2023              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     | No prescription within 6 months |       40 |      0.2 |    24865 |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  4. |                                            variable              |
     |              csDMARD in primary care, Apr 2022-2023              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                    Outside 2021 |    24815 |     99.8 |    24865 |
     +------------------------------------------------------------------+
file /workspace/output/data/drug_byyearanddisease_all.dta saved
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +------------------------------------------------------------------+
  1. |                                            variable              |
     |              csDMARD in primary care, Apr 2021-2022              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                 Within 3 months |       75 |      0.3 |    24865 |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  2. |                                            variable              |
     |              csDMARD in primary care, Apr 2021-2022              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                      3-6 months |       60 |      0.2 |    24865 |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  3. |                                            variable              |
     |              csDMARD in primary care, Apr 2021-2022              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     | No prescription within 6 months |      645 |      2.6 |    24865 |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  4. |                                            variable              |
     |              csDMARD in primary care, Apr 2021-2022              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                    Outside 2021 |    24085 |     96.9 |    24865 |
     +------------------------------------------------------------------+
file /workspace/output/data/drug_byyearanddisease_all.dta saved
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +------------------------------------------------------------------+
  1. |                                            variable              |
     |              csDMARD in primary care, Apr 2020-2021              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                 Within 3 months |      495 |      2.0 |    24865 |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  2. |                                            variable              |
     |              csDMARD in primary care, Apr 2020-2021              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                      3-6 months |      300 |      1.2 |    24865 |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  3. |                                            variable              |
     |              csDMARD in primary care, Apr 2020-2021              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     | No prescription within 6 months |     3985 |     16.0 |    24865 |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  4. |                                            variable              |
     |              csDMARD in primary care, Apr 2020-2021              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                    Outside 2020 |    20085 |     80.8 |    24865 |
     +------------------------------------------------------------------+
file /workspace/output/data/drug_byyearanddisease_all.dta saved
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +------------------------------------------------------------------+
  1. |                                            variable              |
     |              csDMARD in primary care, Apr 2019-2020              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                 Within 3 months |     1875 |      7.5 |    24870 |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  2. |                                            variable              |
     |              csDMARD in primary care, Apr 2019-2020              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                      3-6 months |     1145 |      4.6 |    24870 |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  3. |                                            variable              |
     |              csDMARD in primary care, Apr 2019-2020              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     | No prescription within 6 months |    16235 |     65.3 |    24870 |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  4. |                                            variable              |
     |              csDMARD in primary care, Apr 2019-2020              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                    Outside 2019 |     5615 |     22.6 |    24870 |
     +------------------------------------------------------------------+
file /workspace/output/data/drug_byyearanddisease_all.dta saved
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +----------------------------------------------------------------------+
  1. |                           variable |                      categories |
     | Hydroxychloroquine in primary care |                 Within 3 months |
     |----------------------------------------------------------------------|
     |       count_~l       |       percen~l        |       total_~l        |
     |            480       |            1.9        |          24865        |
     +----------------------------------------------------------------------+

     +----------------------------------------------------------------------+
  2. |                           variable |                      categories |
     | Hydroxychloroquine in primary care |                      3-6 months |
     |----------------------------------------------------------------------|
     |       count_~l       |       percen~l        |       total_~l        |
     |            315       |            1.3        |          24865        |
     +----------------------------------------------------------------------+

     +----------------------------------------------------------------------+
  3. |                           variable |                      categories |
     | Hydroxychloroquine in primary care | No prescription within 6 months |
     |----------------------------------------------------------------------|
     |       count_~l       |       percen~l        |       total_~l        |
     |          24070       |           96.8        |          24865        |
     +----------------------------------------------------------------------+
(note: variable variable was str34, now str38 to accommodate using data's
       values)
file /workspace/output/data/drug_byyearanddisease_all.dta saved
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +-----------------------------------------------------------------+
  1. |                      variable |                      categories |
     | Sulfasalazine in primary care |                 Within 3 months |
     |-----------------------------------------------------------------|
     |      count_~l       |      percen~l       |      total_~l       |
     |           530       |           2.1       |         24870       |
     +-----------------------------------------------------------------+

     +-----------------------------------------------------------------+
  2. |                      variable |                      categories |
     | Sulfasalazine in primary care |                      3-6 months |
     |-----------------------------------------------------------------|
     |      count_~l       |      percen~l       |      total_~l       |
     |           320       |           1.3       |         24870       |
     +-----------------------------------------------------------------+

     +-----------------------------------------------------------------+
  3. |                      variable |                      categories |
     | Sulfasalazine in primary care | No prescription within 6 months |
     |-----------------------------------------------------------------|
     |      count_~l       |      percen~l       |      total_~l       |
     |         24020       |          96.6       |         24870       |
     +-----------------------------------------------------------------+
(note: variable variable was str29, now str38 to accommodate using data's
       values)
file /workspace/output/data/drug_byyearanddisease_all.dta saved
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +----------------------------------------------------------------+
  1. |                     variable |                      categories |
     | Methotrexate in primary care |                 Within 3 months |
     |----------------------------------------------------------------|
     |      count_~l      |      percen~l       |      total_~l       |
     |          1025      |           4.1       |         24865       |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  2. |                     variable |                      categories |
     | Methotrexate in primary care |                      3-6 months |
     |----------------------------------------------------------------|
     |      count_~l      |      percen~l       |      total_~l       |
     |           695      |           2.8       |         24865       |
     +----------------------------------------------------------------+

     +----------------------------------------------------------------+
  3. |                     variable |                      categories |
     | Methotrexate in primary care | No prescription within 6 months |
     |----------------------------------------------------------------|
     |      count_~l      |      percen~l       |      total_~l       |
     |         23145      |          93.1       |         24865       |
     +----------------------------------------------------------------+
(note: variable variable was str28, now str38 to accommodate using data's
       values)
file /workspace/output/data/drug_byyearanddisease_all.dta saved
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------------------------------------------+
  1. |                         variable |                      categories |
     | csDMARD in primary care, overall |                 Within 3 months |
     |--------------------------------------------------------------------|
     |       count_~l       |       percen~l       |       total_~l       |
     |           2450       |            9.9       |          24865       |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  2. |                         variable |                      categories |
     | csDMARD in primary care, overall |                      3-6 months |
     |--------------------------------------------------------------------|
     |       count_~l       |       percen~l       |       total_~l       |
     |           1510       |            6.1       |          24865       |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  3. |                         variable |                      categories |
     | csDMARD in primary care, overall | No prescription within 6 months |
     |--------------------------------------------------------------------|
     |       count_~l       |       percen~l       |       total_~l       |
     |          20905       |           84.1       |          24865       |
     +--------------------------------------------------------------------+
(note: variable variable was str32, now str38 to accommodate using data's
       values)
file /workspace/output/data/drug_byyearanddisease_all.dta saved

. use "$projectdir/output/data/drug_byyearanddisease_all.dta", clear

. export excel "$projectdir/output/tables/drug_byyearanddisease_rounded.xls", r
> eplace sheet("Overall") keepcellfmt firstrow(variables)
file /workspace/output/tables/drug_byyearanddisease_rounded.xls saved

. 
. **Baseline table for EIA subdiagnoses - tagged to above excel
. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==. 
(37,361 observations deleted)

. keep if ra_code==1 | psa_code==1 | undiff_code==1
(8,278 observations deleted)

. 
. local index=0

. levelsof eia_diag, local(levels)
`"PsA"' `"RA"' `"Undiff_IA"'

. foreach i of local levels {
  2.         clear *
  3.         save "$projectdir/output/data/drug_byyearanddisease_`i'.dta", repl
> ace emptyok
  4.         di `index'
  5.         if `index'==0 {
  6.                 local col = word("`c(ALPHA)'", `index'+6)
  7.         }
  8.         else if `index'>0 & `index'<=21 {
  9.             local col = word("`c(ALPHA)'", `index'+4)
 10.         }
 11.         di "`col'"
 12.         if `index'==0 {
 13.                 local `index++'
 14.                 local `index++'
 15.                 local `index++'
 16.                 local `index++'
 17.                 local `index++'
 18.         }
 19.         else {
 20.             local `index++'
 21.                 local `index++'
 22.                 local `index++'
 23.         }
 24.         di `index'
 25.         
. use "$projectdir/output/data/file_eia_all.dta", clear
 26. 
. keep if has_6m_post_appt==1
 27. keep if ra_code==1 | psa_code==1 | undiff_code==1
 28. 
. foreach var of varlist csdmard_time_22 csdmard_time_21 csdmard_time_20 csdmar
> d_time_19 hcq_time ssz_time mtx_time csdmard_time {
 29.         preserve
 30.         keep if eia_diag=="`i'"
 31.         contract `var'
 32.         local v : variable label `var' 
 33.         gen variable = `"`v'"'
 34.     decode `var', gen(categories)
 35.         gen count = round(_freq, 5)
 36.         egen total = total(count)
 37.         gen percent = round((count/total)*100, 0.1)
 38.         order total, after(percent)
 39.         gen countstr = string(count)
 40.         replace countstr = "<8" if count<=7
 41.         order countstr, after(count)
 42.         drop count
 43.         rename countstr count_`i'
 44.         tostring percent, gen(percentstr) force format(%9.1f)
 45.         replace percentstr = "-" if count =="<8"
 46.         order percentstr, after(percent)
 47.         drop percent
 48.         rename percentstr percent_`i'
 49.         gen totalstr = string(total)
 50.         replace totalstr = "-" if count =="<8"
 51.         order totalstr, after(total)
 52.         drop total
 53.         rename totalstr total_`i'
 54.         list count percent total
 55.         keep count percent total
 56.         append using "$projectdir/output/data/drug_byyearanddisease_`i'.dt
> a"
 57.         save "$projectdir/output/data/drug_byyearanddisease_`i'.dta", repl
> ace
 58.         restore
 59. }
 60. use "$projectdir/output/data/drug_byyearanddisease_`i'.dta", clear
 61. export excel "$projectdir/output/tables/drug_byyearanddisease_rounded.xls"
> , sheet("Overall", modify) cell("`col'1") keepcellfmt firstrow(variables)
 62. }
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearanddisease_PsA.dta saved
0
F
5
(103,305 observations deleted)
(17,687 observations deleted)
(35,069 observations deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |       <8          -          - |
  2. |       <8          -          - |
  3. |       10        0.1      17745 |
  4. |    17735       99.9      17745 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_PsA.dta saved
(35,069 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |       30        0.2      17745 |
  2. |       20        0.1      17745 |
  3. |      240        1.4      17745 |
  4. |    17455       98.4      17745 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_PsA.dta saved
(35,069 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |      175        1.0      17750 |
  2. |      105        0.6      17750 |
  3. |     1330        7.5      17750 |
  4. |    16140       90.9      17750 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_PsA.dta saved
(35,069 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |      635        3.6      17750 |
  2. |      405        2.3      17750 |
  3. |     5460       30.8      17750 |
  4. |    11250       63.4      17750 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_PsA.dta saved
(35,069 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |      165        0.9      17750 |
  2. |      170        1.0      17750 |
  3. |    17415       98.1      17750 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_PsA.dta saved
(35,069 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |      210        1.2      17750 |
  2. |      150        0.8      17750 |
  3. |    17390       98.0      17750 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_PsA.dta saved
(35,069 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |      370        2.1      17750 |
  2. |      330        1.9      17750 |
  3. |    17050       96.1      17750 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_PsA.dta saved
(35,069 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |      890        5.0      17750 |
  2. |      720        4.1      17750 |
  3. |    16140       90.9      17750 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_PsA.dta saved
file /workspace/output/tables/drug_byyearanddisease_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearanddisease_RA.dta saved
5
I
8
(103,305 observations deleted)
(17,687 observations deleted)
(35,179 observations deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)

     +--------------------------------+
     | count_RA   percen~A   total_RA |
     |--------------------------------|
  1. |       <8          -          - |
  2. |       <8          -          - |
  3. |       10        0.1      17635 |
  4. |    17625       99.9      17635 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_RA.dta saved
(35,179 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_RA   percen~A   total_RA |
     |--------------------------------|
  1. |       20        0.1      17645 |
  2. |       20        0.1      17645 |
  3. |      205        1.2      17645 |
  4. |    17400       98.6      17645 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_RA.dta saved
(35,179 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_RA   percen~A   total_RA |
     |--------------------------------|
  1. |      155        0.9      17640 |
  2. |      105        0.6      17640 |
  3. |     1325        7.5      17640 |
  4. |    16055       91.0      17640 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_RA.dta saved
(35,179 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_RA   percen~A   total_RA |
     |--------------------------------|
  1. |      615        3.5      17640 |
  2. |      370        2.1      17640 |
  3. |     5425       30.8      17640 |
  4. |    11230       63.7      17640 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_RA.dta saved
(35,179 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_RA   percen~A   total_RA |
     |--------------------------------|
  1. |      175        1.0      17640 |
  2. |      155        0.9      17640 |
  3. |    17310       98.1      17640 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_RA.dta saved
(35,179 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_RA   percen~A   total_RA |
     |--------------------------------|
  1. |      170        1.0      17640 |
  2. |      150        0.9      17640 |
  3. |    17320       98.2      17640 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_RA.dta saved
(35,179 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_RA   percen~A   total_RA |
     |--------------------------------|
  1. |      355        2.0      17635 |
  2. |      295        1.7      17635 |
  3. |    16985       96.3      17635 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_RA.dta saved
(35,179 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_RA   percen~A   total_RA |
     |--------------------------------|
  1. |      840        4.8      17635 |
  2. |      690        3.9      17635 |
  3. |    16105       91.3      17635 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_RA.dta saved
file /workspace/output/tables/drug_byyearanddisease_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearanddisease_Undiff_IA.dta saved
8
L
11
(103,305 observations deleted)
(17,687 observations deleted)
(35,388 observations deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |       <8          -          - |
  2. |       <8          -          - |
  3. |       15        0.1      17425 |
  4. |    17410       99.9      17425 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_Undiff_IA.dta saved
(35,388 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |       25        0.1      17425 |
  2. |       20        0.1      17425 |
  3. |      200        1.1      17425 |
  4. |    17180       98.6      17425 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_Undiff_IA.dta saved
(35,388 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |      165        0.9      17435 |
  2. |       95        0.5      17435 |
  3. |     1335        7.7      17435 |
  4. |    15840       90.9      17435 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_Undiff_IA.dta saved
(35,388 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |      630        3.6      17430 |
  2. |      370        2.1      17430 |
  3. |     5345       30.7      17430 |
  4. |    11085       63.6      17430 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_Undiff_IA.dta saved
(35,388 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |      170        1.0      17430 |
  2. |      120        0.7      17430 |
  3. |    17140       98.3      17430 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_Undiff_IA.dta saved
(35,388 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |      180        1.0      17430 |
  2. |      150        0.9      17430 |
  3. |    17100       98.1      17430 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_Undiff_IA.dta saved
(35,388 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |      355        2.0      17430 |
  2. |      300        1.7      17430 |
  3. |    16775       96.2      17430 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_Undiff_IA.dta saved
(35,388 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | count_~A   percen~A   total_~A |
     |--------------------------------|
  1. |      865        5.0      17430 |
  2. |      670        3.8      17430 |
  3. |    15895       91.2      17430 |
     +--------------------------------+
file /workspace/output/data/drug_byyearanddisease_Undiff_IA.dta saved
file /workspace/output/tables/drug_byyearanddisease_rounded.xls saved

. 
. **First csDMARD table for all EIA patients (removed leflunomide for OpenSAFEL
> Y report due to small counts with more granular time periods)
. clear *

. save "$projectdir/output/data/first_csdmard.dta", replace emptyok
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==. 
(37,361 observations deleted)

. drop if first_csDMARD==""
(28,925 observations deleted)

. keep if ra_code==1 | psa_code==1 | undiff_code==1
(1,051 observations deleted)

. 
. foreach var of varlist first_csDMARD {
  2.         preserve
  3.         contract `var'
  4.         gen count = round(_freq, 5)
  5.         egen total = total(count)
  6.         gen percent = round((count/total)*100, 0.1)
  7.         order total, after(percent)
  8.         gen countstr = string(count)
  9.         replace countstr = "<8" if count<=7
 10.         order countstr, after(count)
 11.         drop count
 12.         rename countstr count_all
 13.         tostring percent, gen(percentstr) force format(%9.1f)
 14.         replace percentstr = "-" if count =="<8"
 15.         order percentstr, after(percent)
 16.         drop percent
 17.         rename percentstr percent_all
 18.         gen totalstr = string(total)
 19.         replace totalstr = "-" if count =="<8"
 20.         order totalstr, after(total)
 21.         drop total
 22.         rename totalstr total_all
 23.         list first_csDMARD count percent total
 24.         keep first_csDMARD count percent total
 25.         append using "$projectdir/output/data/first_csdmard.dta"
 26.         save "$projectdir/output/data/first_csdmard.dta", replace
 27.         restore
 28. }
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +-----------------------------------------------------+
     |      first_csDMARD   count_~l   percen~l   total_~l |
     |-----------------------------------------------------|
  1. | Hydroxychloroquine        750       23.7       3170 |
  2. |       Methotrexate       1620       51.1       3170 |
  3. |      Sulfasalazine        800       25.2       3170 |
     +-----------------------------------------------------+
file /workspace/output/data/first_csdmard.dta saved

. use "$projectdir/output/data/first_csdmard.dta", clear

. export excel "$projectdir/output/tables/first_csdmard_rounded.xls", replace s
> heet("Overall") keepcellfmt firstrow(variables)
file /workspace/output/tables/first_csdmard_rounded.xls saved

. 
. **First csDMARD table for EIA subdiagnoses - tagged to above excel
. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==. 
(37,361 observations deleted)

. drop if first_csDMARD==""
(28,925 observations deleted)

. keep if ra_code==1 | psa_code==1 | undiff_code==1
(1,051 observations deleted)

. 
. recode appt_year 1=2019
(appt_year: 2414 changes made)

. recode appt_year 2=2020
(appt_year: 638 changes made)

. recode appt_year 3=2021
(appt_year: 107 changes made)

. recode appt_year 4=2022
(appt_year: 9 changes made)

. 
. local index=0

. levelsof appt_year, local(levels)
2019 2020 2021 2022

. foreach i of local levels {
  2.         clear *
  3.         save "$projectdir/output/data/first_csdmard_`i'.dta", replace empt
> yok
  4. di `index'
  5.         if `index'==0 {
  6.                 local col = word("`c(ALPHA)'", `index'+5)
  7.         }
  8.         else if `index'>0 & `index'<=21 {
  9.             local col = word("`c(ALPHA)'", `index'+4)
 10.         }
 11.         di "`col'"
 12.         if `index'==0 {
 13.                 local `index++'
 14.                 local `index++'
 15.                 local `index++'
 16.                 local `index++'
 17.         }
 18.         else {
 19.             local `index++'
 20.                 local `index++'
 21.                 local `index++'
 22.         }
 23.         di `index'
 24.         
. use "$projectdir/output/data/file_eia_all.dta", clear
 25. 
. keep if has_6m_post_appt==1
 26. drop if appt_year>4 | appt_year==. 
 27. drop if first_csDMARD==""
 28. keep if ra_code==1 | psa_code==1 | undiff_code==1
 29. 
. recode appt_year 1=2019
 30. recode appt_year 2=2020
 31. recode appt_year 3=2021
 32. recode appt_year 4=2022
 33. 
. foreach var of varlist first_csDMARD {
 34.         preserve
 35.         keep if appt_year==`i'
 36.         contract `var'
 37.         gen count = round(_freq, 5)
 38.         egen total = total(count)
 39.         gen percent = round((count/total)*100, 0.1)
 40.         order total, after(percent)
 41.         gen countstr = string(count)
 42.         replace countstr = "<8" if count<=7
 43.         order countstr, after(count)
 44.         drop count
 45.         rename countstr count_`i'
 46.         tostring percent, gen(percentstr) force format(%9.1f)
 47.         replace percentstr = "-" if count =="<8"
 48.         order percentstr, after(percent)
 49.         drop percent
 50.         rename percentstr percent_`i'
 51.         gen totalstr = string(total)
 52.         replace totalstr = "-" if count =="<8"
 53.         order totalstr, after(total)
 54.         drop total
 55.         rename totalstr total_`i'
 56.         list count percent total
 57.         keep count percent total
 58.         append using "$projectdir/output/data/first_csdmard_`i'.dta"
 59.         save "$projectdir/output/data/first_csdmard_`i'.dta", replace
 60.         restore
 61. }
 62. 
. display `index'
 63. display "`col'"
 64. use "$projectdir/output/data/first_csdmard_`i'.dta", clear
 65. export excel "$projectdir/output/tables/first_csdmard_rounded.xls", sheet(
> "Overall", modify) cell("`col'1") keepcellfmt firstrow(variables)
 66. }
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_2019.dta saved
0
E
4
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(appt_year: 2414 changes made)
(appt_year: 638 changes made)
(appt_year: 107 changes made)
(appt_year: 9 changes made)
(754 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | cou~2019   per~2019   tot~2019 |
     |--------------------------------|
  1. |      560       23.2       2415 |
  2. |     1255       52.0       2415 |
  3. |      600       24.8       2415 |
     +--------------------------------+
file /workspace/output/data/first_csdmard_2019.dta saved
4
E
file /workspace/output/tables/first_csdmard_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_2020.dta saved
4
H
7
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(appt_year: 2414 changes made)
(appt_year: 638 changes made)
(appt_year: 107 changes made)
(appt_year: 9 changes made)
(2,530 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | cou~2020   per~2020   tot~2020 |
     |--------------------------------|
  1. |      160       25.0        640 |
  2. |      315       49.2        640 |
  3. |      165       25.8        640 |
     +--------------------------------+
file /workspace/output/data/first_csdmard_2020.dta saved
7
H
file /workspace/output/tables/first_csdmard_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_2021.dta saved
7
K
10
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(appt_year: 2414 changes made)
(appt_year: 638 changes made)
(appt_year: 107 changes made)
(appt_year: 9 changes made)
(3,061 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | cou~2021   per~2021   tot~2021 |
     |--------------------------------|
  1. |       30       27.3        110 |
  2. |       50       45.5        110 |
  3. |       30       27.3        110 |
     +--------------------------------+
file /workspace/output/data/first_csdmard_2021.dta saved
10
K
file /workspace/output/tables/first_csdmard_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_2022.dta saved
10
N
13
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(appt_year: 2414 changes made)
(appt_year: 638 changes made)
(appt_year: 107 changes made)
(appt_year: 9 changes made)
(3,159 observations deleted)
variable countstr was str1 now str2
(3 real changes made)
percentstr generated as str4
(3 real changes made)
(3 real changes made)

     +--------------------------------+
     | cou~2022   per~2022   tot~2022 |
     |--------------------------------|
  1. |       <8          -          - |
  2. |       <8          -          - |
  3. |       <8          -          - |
     +--------------------------------+
file /workspace/output/data/first_csdmard_2022.dta saved
13
N
file /workspace/output/tables/first_csdmard_rounded.xls saved

. 
. **First csDMARD table for all EIA patients - version used for report (removed
>  leflunomide due to small counts with more granular time periods)
. clear *

. save "$projectdir/output/data/first_csdmard_report.dta", replace emptyok
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_report.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==.
(37,361 observations deleted)

. drop if first_csDMARD==""
(28,925 observations deleted)

. keep if ra_code==1 | psa_code==1 | undiff_code==1
(1,051 observations deleted)

. 
. foreach var of varlist first_csDMARD {
  2.         preserve
  3.         contract `var'
  4.         gen count = round(_freq, 5)
  5.         egen total = total(count)
  6.         gen percent = round((count/total)*100, 0.1)
  7.         order total, after(percent)
  8.         gen countstr = string(count)
  9.         replace countstr = "<8" if count<=7
 10.         order countstr, after(count)
 11.         drop count
 12.         rename countstr count_all
 13.         tostring percent, gen(percentstr) force format(%9.1f)
 14.         replace percentstr = "-" if count =="<8"
 15.         order percentstr, after(percent)
 16.         drop percent
 17.         rename percentstr percent_all
 18.         gen totalstr = string(total)
 19.         replace totalstr = "-" if count =="<8"
 20.         order totalstr, after(total)
 21.         drop total
 22.         rename totalstr total_all
 23.         list first_csDMARD count percent
 24.         keep first_csDMARD count percent
 25.         append using "$projectdir/output/data/first_csdmard_report.dta"
 26.         save "$projectdir/output/data/first_csdmard_report.dta", replace
 27.         restore
 28. }
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +------------------------------------------+
     |      first_csDMARD   count_~l   percen~l |
     |------------------------------------------|
  1. | Hydroxychloroquine        750       23.7 |
  2. |       Methotrexate       1620       51.1 |
  3. |      Sulfasalazine        800       25.2 |
     +------------------------------------------+
file /workspace/output/data/first_csdmard_report.dta saved

. use "$projectdir/output/data/first_csdmard_report.dta", clear

. export excel "$projectdir/output/tables/first_csdmard_rounded_report.xls", re
> place sheet("Overall") keepcellfmt firstrow(variables)
file /workspace/output/tables/first_csdmard_rounded_report.xls saved

. 
. **First csDMARD table for EIA subdiagnoses - tagged to above excel
. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==.
(37,361 observations deleted)

. drop if first_csDMARD==""
(28,925 observations deleted)

. keep if ra_code==1 | psa_code==1 | undiff_code==1
(1,051 observations deleted)

. 
. local index=0

. levelsof appt_3m, local(levels)
1 2 3 4 5 6 7 8 9 10 11 12 13

. foreach i of local levels {
  2.         clear *
  3.         save "$projectdir/output/data/first_csdmard_`i'_report.dta", repla
> ce emptyok
  4. di `index'
  5.         if `index'==0 {
  6.                 local col = word("`c(ALPHA)'", `index'+4)
  7.         }
  8.         else if `index'>0 & `index'<=21 {
  9.             local col = word("`c(ALPHA)'", `index'+3)
 10.         }
 11.         else if `index'==23 {
 12.             local col = "Z"
 13.         }
 14.         else if `index'==25 {
 15.             local col = "AB"
 16.         }       
 17.         di "`col'"
 18.         if `index'==0 {
 19.                 local `index++'
 20.                 local `index++'
 21.                 local `index++'
 22.         }
 23.         else {
 24.             local `index++'
 25.                 local `index++'
 26.         }
 27.         di `index'
 28. 
. use "$projectdir/output/data/file_eia_all.dta", clear
 29. 
. keep if has_6m_post_appt==1
 30. drop if appt_year>4 | appt_year==.
 31. drop if first_csDMARD==""
 32. keep if ra_code==1 | psa_code==1 | undiff_code==1
 33. 
. foreach var of varlist first_csDMARD {
 34.         preserve
 35.         keep if appt_3m==`i'
 36.         contract `var'
 37.         gen count = round(_freq, 5)
 38.         egen total = total(count)
 39.         gen percent = round((count/total)*100, 0.1)
 40.         order total, after(percent)
 41.         gen countstr = string(count)
 42.         replace countstr = "<8" if count<=7
 43.         order countstr, after(count)
 44.         drop count
 45.         rename countstr count_period`i'
 46.         tostring percent, gen(percentstr) force format(%9.1f)
 47.         replace percentstr = "-" if count =="<8"
 48.         order percentstr, after(percent)
 49.         drop percent
 50.         rename percentstr percent_period`i'
 51.         gen totalstr = string(total)
 52.         replace totalstr = "-" if count =="<8"
 53.         order totalstr, after(total)
 54.         drop total
 55.         rename totalstr total_period`i'
 56.         list count percent
 57.         keep count percent
 58.         append using "$projectdir/output/data/first_csdmard_`i'_report.dta
> "
 59.         save "$projectdir/output/data/first_csdmard_`i'_report.dta", repla
> ce
 60.         restore
 61. }
 62. 
. display `index'
 63. display "`col'"
 64. use "$projectdir/output/data/first_csdmard_`i'_report.dta", clear
 65. export excel "$projectdir/output/tables/first_csdmard_rounded_report.xls",
>  sheet("Overall", modify) cell("`col'1") keepcellfmt firstrow(variables)
 66. }
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_1_report.dta saved
0
D
3
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(2,325 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +---------------------+
     | count_~1   percen~1 |
     |---------------------|
  1. |      195       23.2 |
  2. |      430       51.2 |
  3. |      215       25.6 |
     +---------------------+
file /workspace/output/data/first_csdmard_1_report.dta saved
3
D
file /workspace/output/tables/first_csdmard_rounded_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_2_report.dta saved
3
F
5
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(2,435 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +---------------------+
     | count_~2   percen~2 |
     |---------------------|
  1. |      175       24.0 |
  2. |      380       52.1 |
  3. |      175       24.0 |
     +---------------------+
file /workspace/output/data/first_csdmard_2_report.dta saved
5
F
file /workspace/output/tables/first_csdmard_rounded_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_3_report.dta saved
5
H
7
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(2,670 observations deleted)
(0 real changes made)
percentstr generated as str4
(0 real changes made)
(0 real changes made)

     +---------------------+
     | count_~3   percen~3 |
     |---------------------|
  1. |      110       22.0 |
  2. |      255       51.0 |
  3. |      135       27.0 |
     +---------------------+
file /workspace/output/data/first_csdmard_3_report.dta saved
7
H
file /workspace/output/tables/first_csdmard_rounded_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_4_report.dta saved
7
J
9
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(2,828 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +---------------------+
     | count_~4   percen~4 |
     |---------------------|
  1. |       80       23.2 |
  2. |      190       55.1 |
  3. |       75       21.7 |
     +---------------------+
file /workspace/output/data/first_csdmard_4_report.dta saved
9
J
file /workspace/output/tables/first_csdmard_rounded_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_5_report.dta saved
9
L
11
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(2,883 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +---------------------+
     | count_~5   percen~5 |
     |---------------------|
  1. |       80       28.1 |
  2. |      135       47.4 |
  3. |       70       24.6 |
     +---------------------+
file /workspace/output/data/first_csdmard_5_report.dta saved
11
L
file /workspace/output/tables/first_csdmard_rounded_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_6_report.dta saved
11
N
13
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(2,997 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +---------------------+
     | count_~6   percen~6 |
     |---------------------|
  1. |       45       25.7 |
  2. |       80       45.7 |
  3. |       50       28.6 |
     +---------------------+
file /workspace/output/data/first_csdmard_6_report.dta saved
13
N
file /workspace/output/tables/first_csdmard_rounded_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_7_report.dta saved
13
P
15
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(3,054 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +---------------------+
     | count_~7   percen~7 |
     |---------------------|
  1. |       25       22.7 |
  2. |       55       50.0 |
  3. |       30       27.3 |
     +---------------------+
file /workspace/output/data/first_csdmard_7_report.dta saved
15
P
file /workspace/output/tables/first_csdmard_rounded_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_8_report.dta saved
15
R
17
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(3,100 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +---------------------+
     | count_~8   percen~8 |
     |---------------------|
  1. |       10       14.3 |
  2. |       40       57.1 |
  3. |       20       28.6 |
     +---------------------+
file /workspace/output/data/first_csdmard_8_report.dta saved
17
R
file /workspace/output/tables/first_csdmard_rounded_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_9_report.dta saved
17
T
19
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(3,118 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +---------------------+
     | count_~9   percen~9 |
     |---------------------|
  1. |       15       27.3 |
  2. |       25       45.5 |
  3. |       15       27.3 |
     +---------------------+
file /workspace/output/data/first_csdmard_9_report.dta saved
19
T
file /workspace/output/tables/first_csdmard_rounded_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_10_report.dta saved
19
V
21
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(3,139 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +---------------------+
     | count~10   perce~10 |
     |---------------------|
  1. |       10       33.3 |
  2. |       10       33.3 |
  3. |       10       33.3 |
     +---------------------+
file /workspace/output/data/first_csdmard_10_report.dta saved
21
V
file /workspace/output/tables/first_csdmard_rounded_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_11_report.dta saved
21
X
23
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(3,152 observations deleted)
variable countstr was str1 now str2
(3 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(3 real changes made)
(3 real changes made)

     +---------------------+
     | count~11   perce~11 |
     |---------------------|
  1. |       <8          - |
  2. |       <8          - |
  3. |       <8          - |
     +---------------------+
file /workspace/output/data/first_csdmard_11_report.dta saved
23
X
file /workspace/output/tables/first_csdmard_rounded_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_12_report.dta saved
23
Z
25
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(3,156 observations deleted)
variable countstr was str1 now str2
(3 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(3 real changes made)
(3 real changes made)

     +---------------------+
     | count~12   perce~12 |
     |---------------------|
  1. |       <8          - |
  2. |       <8          - |
  3. |       <8          - |
     +---------------------+
file /workspace/output/data/first_csdmard_12_report.dta saved
25
Z
file /workspace/output/tables/first_csdmard_rounded_report.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/first_csdmard_13_report.dta saved
25
AB
27
(103,305 observations deleted)
(37,361 observations deleted)
(28,925 observations deleted)
(1,051 observations deleted)
(3,159 observations deleted)
variable countstr was str1 now str2
(3 real changes made)
percentstr generated as str4
(3 real changes made)
(3 real changes made)

     +---------------------+
     | count~13   perce~13 |
     |---------------------|
  1. |       <8          - |
  2. |       <8          - |
  3. |       <8          - |
     +---------------------+
file /workspace/output/data/first_csdmard_13_report.dta saved
27
AB
file /workspace/output/tables/first_csdmard_rounded_report.xls saved

. 
. **Boxplot outputs - csDMARD standards, all regions
. clear *

. save "$projectdir/output/data/drug_byyearandregion_rounded_all.dta", replace 
> emptyok
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearandregion_rounded_all.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==.
(37,361 observations deleted)

. drop if region_nospace=="Not known"
(327 observations deleted)

. keep if ra_code==1 | psa_code==1 | undiff_code==1
(8,199 observations deleted)

. 
. foreach var of varlist csdmard_time_22 csdmard_time_21 csdmard_time_20 csdmar
> d_time_19 csdmard_time {
  2.         preserve
  3.         contract `var'
  4.         local v : variable label `var' 
  5.         gen variable = `"`v'"'
  6.     decode `var', gen(categories)
  7.         gen count = round(_freq, 5)
  8.         egen total = total(count)
  9.         egen non_missing=sum(count) if categories!=""
 10.         drop if categories==""
 11.         gen percent = round((count/non_missing)*100, 0.1)
 12.         gen missing=(total-non_missing)
 13.         order total, after(percent)
 14.         order missing, after(total)
 15.         gen countstr = string(count)
 16.         replace countstr = "<8" if count<=7
 17.         order countstr, after(count)
 18.         drop count
 19.         rename countstr count_all
 20.         tostring percent, gen(percentstr) force format(%9.1f)
 21.         replace percentstr = "-" if count =="<8"
 22.         order percentstr, after(percent)
 23.         drop percent
 24.         rename percentstr percent_all
 25.         gen totalstr = string(total)
 26.         replace totalstr = "-" if count =="<8"
 27.         order totalstr, after(total)
 28.         drop total
 29.         rename totalstr total_all
 30.         gen missingstr = string(missing)
 31.         replace missingstr = "-" if count =="<8"
 32.         order missingstr, after(missing)
 33.         drop missing
 34.         rename missingstr missing_all
 35.         list variable categories count percent total missing
 36.         keep variable categories count percent total missing
 37.         append using "$projectdir/output/data/drug_byyearandregion_rounded
> _all.dta"
 38.         save "$projectdir/output/data/drug_byyearandregion_rounded_all.dta
> ", replace
 39.         restore
 40. }
(0 observations deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +------------------------------------------------------------------+
  1. |                                            variable              |
     |              csDMARD in primary care, Apr 2022-2023              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                 Within 3 months |       <8 |        - |        - |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    -                             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  2. |                                            variable              |
     |              csDMARD in primary care, Apr 2022-2023              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                      3-6 months |       <8 |        - |        - |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    -                             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  3. |                                            variable              |
     |              csDMARD in primary care, Apr 2022-2023              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     | No prescription within 6 months |       40 |      0.2 |    24620 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  4. |                                            variable              |
     |              csDMARD in primary care, Apr 2022-2023              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                    Outside 2021 |    24570 |     99.8 |    24620 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +------------------------------------------------------------------+
  1. |                                            variable              |
     |              csDMARD in primary care, Apr 2021-2022              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                 Within 3 months |       75 |      0.3 |    24615 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  2. |                                            variable              |
     |              csDMARD in primary care, Apr 2021-2022              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                      3-6 months |       60 |      0.2 |    24615 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  3. |                                            variable              |
     |              csDMARD in primary care, Apr 2021-2022              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     | No prescription within 6 months |      640 |      2.6 |    24615 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  4. |                                            variable              |
     |              csDMARD in primary care, Apr 2021-2022              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                    Outside 2021 |    23840 |     96.9 |    24615 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +------------------------------------------------------------------+
  1. |                                            variable              |
     |              csDMARD in primary care, Apr 2020-2021              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                 Within 3 months |      490 |      2.0 |    24615 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  2. |                                            variable              |
     |              csDMARD in primary care, Apr 2020-2021              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                      3-6 months |      300 |      1.2 |    24615 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  3. |                                            variable              |
     |              csDMARD in primary care, Apr 2020-2021              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     | No prescription within 6 months |     3940 |     16.0 |    24615 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  4. |                                            variable              |
     |              csDMARD in primary care, Apr 2020-2021              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                    Outside 2020 |    19885 |     80.8 |    24615 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +------------------------------------------------------------------+
  1. |                                            variable              |
     |              csDMARD in primary care, Apr 2019-2020              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                 Within 3 months |     1855 |      7.5 |    24620 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  2. |                                            variable              |
     |              csDMARD in primary care, Apr 2019-2020              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                      3-6 months |     1130 |      4.6 |    24620 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  3. |                                            variable              |
     |              csDMARD in primary care, Apr 2019-2020              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     | No prescription within 6 months |    16075 |     65.3 |    24620 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
  4. |                                            variable              |
     |              csDMARD in primary care, Apr 2019-2020              |
     |------------------------------------------------------------------|
     |                      categories | count_~l | percen~l | total_~l |
     |                    Outside 2019 |     5560 |     22.6 |    24620 |
     |------------------------------------------------------------------|
     |                             missin~l                             |
     |                                    0                             |
     +------------------------------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_all.dta saved
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +--------------------------------------------------------------------+
  1. |                         variable |                      categories |
     | csDMARD in primary care, overall |                 Within 3 months |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |        2430    |         9.9    |       24620    |           0     |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  2. |                         variable |                      categories |
     | csDMARD in primary care, overall |                      3-6 months |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |        1495    |         6.1    |       24620    |           0     |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  3. |                         variable |                      categories |
     | csDMARD in primary care, overall | No prescription within 6 months |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |       20695    |        84.1    |       24620    |           0     |
     +--------------------------------------------------------------------+
(note: variable variable was str32, now str38 to accommodate using data's
       values)
file /workspace/output/data/drug_byyearandregion_rounded_all.dta saved

. use "$projectdir/output/data/drug_byyearandregion_rounded_all.dta", clear

. export excel "$projectdir/output/tables/drug_byyearandregion_rounded.xls", re
> place sheet("Overall") keepcellfmt firstrow(variables)
file /workspace/output/tables/drug_byyearandregion_rounded.xls saved

. 
. **Boxplot outputs - csDMARD outputs by region
. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==.
(37,361 observations deleted)

. drop if region_nospace=="Not known"
(327 observations deleted)

. keep if ra_code==1 | psa_code==1 | undiff_code==1
(8,199 observations deleted)

. 
. local index=0

. levelsof region_nospace, local(levels)
`"East"' `"EastMidlands"' `"London"' `"NorthEast"' `"NorthWest"' `"SouthEast"' 
> `"SouthWest"' `"WestMidlands"' `"YorkshireandTheHumber"'

. foreach i of local levels {
  2.         clear *
  3.         save "$projectdir/output/data/drug_byyearandregion_rounded_`i'.dta
> ", replace emptyok
  4.         di `index'
  5.         if `index'==0 {
  6.                 local col = word("`c(ALPHA)'", `index'+7)
  7.         }
  8.         else if `index'>0 & `index'<=21 {
  9.             local col = word("`c(ALPHA)'", `index'+5)
 10.         }
 11.         else if `index'==22 {
 12.             local col = "AA"
 13.         }
 14.         else if `index'==26 {
 15.             local col = "AE"
 16.         }       
 17.         else if `index'==30 {
 18.             local col = "AI"    
 19.         }       
 20.         else if `index'==34 {
 21.             local col = "AM"
 22.         }
 23.         di "`col'"
 24.         if `index'==0 {
 25.                 local `index++'
 26.                 local `index++'
 27.                 local `index++'
 28.                 local `index++'
 29.                 local `index++'
 30.                 local `index++'
 31.         }
 32.         else {
 33.             local `index++'
 34.                 local `index++'
 35.                 local `index++'
 36.                 local `index++'
 37.         }
 38.         di `index'      
 39.         
. use "$projectdir/output/data/file_eia_all.dta", clear
 40. 
. keep if has_6m_post_appt==1
 41. drop if appt_year>4 | appt_year==.
 42. drop if region_nospace=="Not known"
 43. keep if ra_code==1 | psa_code==1 | undiff_code==1
 44. 
. foreach var of varlist csdmard_time_22 csdmard_time_21 csdmard_time_20 csdmar
> d_time_19 csdmard_time {
 45.         preserve
 46.         keep if region_nospace=="`i'"
 47.         contract `var'
 48.         local v : variable label `var' 
 49.         gen variable = `"`v'"'
 50.     decode `var', gen(categories)
 51.         gen count = round(_freq, 5)
 52.         egen total = total(count)
 53.         egen non_missing=sum(count) if categories!=""
 54.         drop if categories==""
 55.         gen percent = round((count/non_missing)*100, 0.1)
 56.         gen missing=(total-non_missing)
 57.         order total, after(percent)
 58.         order missing, after(total)
 59.         gen countstr = string(count)
 60.         replace countstr = "<8" if count<=7
 61.         order countstr, after(count)
 62.         drop count
 63.         rename countstr count_`i'
 64.         tostring percent, gen(percentstr) force format(%9.1f)
 65.         replace percentstr = "-" if count =="<8"
 66.         order percentstr, after(percent)
 67.         drop percent
 68.         rename percentstr percent_`i'
 69.         gen totalstr = string(total)
 70.         replace totalstr = "-" if count =="<8"
 71.         order totalstr, after(total)
 72.         drop total
 73.         rename totalstr total_`i'
 74.         gen missingstr = string(missing)
 75.         replace missingstr = "-" if count =="<8"
 76.         order missingstr, after(missing)
 77.         drop missing
 78.         rename missingstr missing_`i'
 79.         list count percent total missing
 80.         keep count percent total missing
 81.         append using "$projectdir/output/data/drug_byyearandregion_rounded
> _`i'.dta"
 82.         save "$projectdir/output/data/drug_byyearandregion_rounded_`i'.dta
> ", replace
 83.         restore
 84. }
 85. display `index'
 86. display "`col'"
 87. use "$projectdir/output/data/drug_byyearandregion_rounded_`i'.dta", clear
 88. export excel "$projectdir/output/tables/drug_byyearandregion_rounded.xls",
>  sheet("Overall", modify) cell("`col'1") keepcellfmt firstrow(variables)
 89. }
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearandregion_rounded_East.dta saved
0
G
6
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(8,199 observations deleted)
(22,196 observations deleted)
(0 observations deleted)
(3 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(3 real changes made)
(3 real changes made)
(3 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
  3. |       <8          -          -          - |
  4. |     2415       99.8       2420          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_East.dta saved
(22,196 observations deleted)
(0 observations deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       10        0.4       2420          0 |
  3. |       70        2.9       2420          0 |
  4. |     2335       96.5       2420          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_East.dta saved
(22,196 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       50        2.1       2420          0 |
  2. |       20        0.8       2420          0 |
  3. |      375       15.5       2420          0 |
  4. |     1975       81.6       2420          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_East.dta saved
(22,196 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |      185        7.6       2420          0 |
  2. |      110        4.5       2420          0 |
  3. |     1585       65.5       2420          0 |
  4. |      540       22.3       2420          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_East.dta saved
(22,196 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |      245       10.1       2425          0 |
  2. |      140        5.8       2425          0 |
  3. |     2040       84.1       2425          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_East.dta saved
6
G
file /workspace/output/tables/drug_byyearandregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearandregion_rounded_EastMidlands.dta saved
6
K
10
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(8,199 observations deleted)
(22,167 observations deleted)
(0 observations deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
  3. |     2445       99.8       2450          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_EastMidlands.dta saved
(22,167 observations deleted)
(0 observations deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
  3. |       60        2.4       2450          0 |
  4. |     2380       97.1       2450          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_EastMidlands.dta saved
(22,167 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       45        1.8       2450          0 |
  2. |       30        1.2       2450          0 |
  3. |      410       16.7       2450          0 |
  4. |     1965       80.2       2450          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_EastMidlands.dta saved
(22,167 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |      180        7.3       2450          0 |
  2. |      110        4.5       2450          0 |
  3. |     1600       65.3       2450          0 |
  4. |      560       22.9       2450          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_EastMidlands.dta saved
(22,167 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |      235        9.6       2455          0 |
  2. |      150        6.1       2455          0 |
  3. |     2070       84.3       2455          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_EastMidlands.dta saved
10
K
file /workspace/output/tables/drug_byyearandregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearandregion_rounded_London.dta saved
10
O
14
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(8,199 observations deleted)
(19,732 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~n   percen~n   total_~n   missin~n |
     |-------------------------------------------|
  1. |       10        0.2       4885          0 |
  2. |     4875       99.8       4885          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_London.dta saved
(19,732 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~n   percen~n   total_~n   missin~n |
     |-------------------------------------------|
  1. |       20        0.4       4890          0 |
  2. |       15        0.3       4890          0 |
  3. |      140        2.9       4890          0 |
  4. |     4715       96.4       4890          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_London.dta saved
(19,732 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~n   percen~n   total_~n   missin~n |
     |-------------------------------------------|
  1. |      100        2.0       4885          0 |
  2. |       60        1.2       4885          0 |
  3. |      785       16.1       4885          0 |
  4. |     3940       80.7       4885          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_London.dta saved
(19,732 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~n   percen~n   total_~n   missin~n |
     |-------------------------------------------|
  1. |      375        7.7       4890          0 |
  2. |      235        4.8       4890          0 |
  3. |     3155       64.5       4890          0 |
  4. |     1125       23.0       4890          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_London.dta saved
(19,732 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~n   percen~n   total_~n   missin~n |
     |-------------------------------------------|
  1. |      490       10.0       4885          0 |
  2. |      310        6.3       4885          0 |
  3. |     4085       83.6       4885          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_London.dta saved
14
O
file /workspace/output/tables/drug_byyearandregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearandregion_rounded_NorthEast.dta saved
14
S
18
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(8,199 observations deleted)
(22,116 observations deleted)
(0 observations deleted)
(1 real change made)
percentstr generated as str5
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |     2500      100.0       2500          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_NorthEast.dta saved
(22,116 observations deleted)
(0 observations deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
  3. |       60        2.4       2500          0 |
  4. |     2430       97.2       2500          0 |
     +-------------------------------------------+
(note: variable percent_NorthEast was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/drug_byyearandregion_rounded_NorthEast.dta saved
(22,116 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       45        1.8       2505          0 |
  2. |       35        1.4       2505          0 |
  3. |      385       15.4       2505          0 |
  4. |     2040       81.4       2505          0 |
     +-------------------------------------------+
(note: variable percent_NorthEast was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/drug_byyearandregion_rounded_NorthEast.dta saved
(22,116 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |      190        7.6       2500          0 |
  2. |      110        4.4       2500          0 |
  3. |     1665       66.6       2500          0 |
  4. |      535       21.4       2500          0 |
     +-------------------------------------------+
(note: variable percent_NorthEast was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/drug_byyearandregion_rounded_NorthEast.dta saved
(22,116 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |      240        9.6       2500          0 |
  2. |      150        6.0       2500          0 |
  3. |     2110       84.4       2500          0 |
     +-------------------------------------------+
(note: variable percent_NorthEast was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/drug_byyearandregion_rounded_NorthEast.dta saved
18
S
file /workspace/output/tables/drug_byyearandregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearandregion_rounded_NorthWest.dta saved
18
W
22
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(8,199 observations deleted)
(22,134 observations deleted)
(0 observations deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |     2480       99.8       2485          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_NorthWest.dta saved
(22,134 observations deleted)
(0 observations deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
  3. |       70        2.8       2485          0 |
  4. |     2405       96.8       2485          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_NorthWest.dta saved
(22,134 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       60        2.4       2485          0 |
  2. |       35        1.4       2485          0 |
  3. |      375       15.1       2485          0 |
  4. |     2015       81.1       2485          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_NorthWest.dta saved
(22,134 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |      195        7.8       2485          0 |
  2. |      120        4.8       2485          0 |
  3. |     1620       65.2       2485          0 |
  4. |      550       22.1       2485          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_NorthWest.dta saved
(22,134 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |      260       10.5       2485          0 |
  2. |      155        6.2       2485          0 |
  3. |     2070       83.3       2485          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_NorthWest.dta saved
22
W
file /workspace/output/tables/drug_byyearandregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearandregion_rounded_SouthEast.dta saved
22
AA
26
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(8,199 observations deleted)
(22,166 observations deleted)
(0 observations deleted)
(3 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(3 real changes made)
(3 real changes made)
(3 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
  3. |       <8          -          -          - |
  4. |     2445       99.8       2450          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_SouthEast.dta saved
(22,166 observations deleted)
(0 observations deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
  3. |       50        2.0       2450          0 |
  4. |     2390       97.6       2450          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_SouthEast.dta saved
(22,166 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       55        2.2       2455          0 |
  2. |       25        1.0       2455          0 |
  3. |      415       16.9       2455          0 |
  4. |     1960       79.8       2455          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_SouthEast.dta saved
(22,166 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |      190        7.8       2450          0 |
  2. |      100        4.1       2450          0 |
  3. |     1600       65.3       2450          0 |
  4. |      560       22.9       2450          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_SouthEast.dta saved
(22,166 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |      250       10.2       2455          0 |
  2. |      135        5.5       2455          0 |
  3. |     2070       84.3       2455          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_SouthEast.dta saved
26
AA
file /workspace/output/tables/drug_byyearandregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearandregion_rounded_SouthWest.dta saved
26
AE
30
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(8,199 observations deleted)
(22,186 observations deleted)
(0 observations deleted)
(3 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(3 real changes made)
(3 real changes made)
(3 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
  3. |       <8          -          -          - |
  4. |     2425       99.8       2430          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_SouthWest.dta saved
(22,186 observations deleted)
(0 observations deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       10        0.4       2435          0 |
  2. |       <8          -          -          - |
  3. |       65        2.7       2435          0 |
  4. |     2355       96.7       2435          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_SouthWest.dta saved
(22,186 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       40        1.6       2425          0 |
  2. |       20        0.8       2425          0 |
  3. |      390       16.1       2425          0 |
  4. |     1975       81.4       2425          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_SouthWest.dta saved
(22,186 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |      180        7.4       2430          0 |
  2. |      110        4.5       2430          0 |
  3. |     1600       65.8       2430          0 |
  4. |      540       22.2       2430          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_SouthWest.dta saved
(22,186 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |      230        9.5       2430          0 |
  2. |      135        5.6       2430          0 |
  3. |     2065       85.0       2430          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_SouthWest.dta saved
30
AE
file /workspace/output/tables/drug_byyearandregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearandregion_rounded_WestMidlands.dta saved
30
AI
34
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(8,199 observations deleted)
(22,131 observations deleted)
(0 observations deleted)
(1 real change made)
percentstr generated as str5
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |     2485      100.0       2485          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_WestMidlands.dta saved
(22,131 observations deleted)
(0 observations deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       10        0.4       2485          0 |
  2. |       <8          -          -          - |
  3. |       65        2.6       2485          0 |
  4. |     2405       96.8       2485          0 |
     +-------------------------------------------+
(note: variable percent_WestMidlands was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/drug_byyearandregion_rounded_WestMidlands.dta saved
(22,131 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       50        2.0       2490          0 |
  2. |       35        1.4       2490          0 |
  3. |      420       16.9       2490          0 |
  4. |     1985       79.7       2490          0 |
     +-------------------------------------------+
(note: variable percent_WestMidlands was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/drug_byyearandregion_rounded_WestMidlands.dta saved
(22,131 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |      180        7.2       2485          0 |
  2. |      120        4.8       2485          0 |
  3. |     1600       64.4       2485          0 |
  4. |      585       23.5       2485          0 |
     +-------------------------------------------+
(note: variable percent_WestMidlands was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/drug_byyearandregion_rounded_WestMidlands.dta saved
(22,131 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |      245        9.9       2485          0 |
  2. |      155        6.2       2485          0 |
  3. |     2085       83.9       2485          0 |
     +-------------------------------------------+
(note: variable percent_WestMidlands was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/drug_byyearandregion_rounded_WestMidlands.dta saved
34
AI
file /workspace/output/tables/drug_byyearandregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/drug_byyearandregion_rounded_YorkshireandTheHumber.
> dta saved
34
AM
38
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(8,199 observations deleted)
(22,116 observations deleted)
(0 observations deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~r   percen~r   total_~r   missin~r |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |     2500       99.8       2505          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_YorkshireandTheHumber.
> dta saved
(22,116 observations deleted)
(0 observations deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~r   percen~r   total_~r   missin~r |
     |-------------------------------------------|
  1. |       10        0.4       2500          0 |
  2. |       <8          -          -          - |
  3. |       65        2.6       2500          0 |
  4. |     2420       96.8       2500          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_YorkshireandTheHumber.
> dta saved
(22,116 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~r   percen~r   total_~r   missin~r |
     |-------------------------------------------|
  1. |       45        1.8       2500          0 |
  2. |       40        1.6       2500          0 |
  3. |      385       15.4       2500          0 |
  4. |     2030       81.2       2500          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_YorkshireandTheHumber.
> dta saved
(22,116 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~r   percen~r   total_~r   missin~r |
     |-------------------------------------------|
  1. |      180        7.2       2505          0 |
  2. |      120        4.8       2505          0 |
  3. |     1645       65.7       2505          0 |
  4. |      560       22.4       2505          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_YorkshireandTheHumber.
> dta saved
(22,116 observations deleted)
(0 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~r   percen~r   total_~r   missin~r |
     |-------------------------------------------|
  1. |      235        9.4       2500          0 |
  2. |      165        6.6       2500          0 |
  3. |     2100       84.0       2500          0 |
     +-------------------------------------------+
file /workspace/output/data/drug_byyearandregion_rounded_YorkshireandTheHumber.
> dta saved
38
AM
file /workspace/output/tables/drug_byyearandregion_rounded.xls saved

. 
. **Boxplot outputs - referral standards, all regions
. clear *

. save "$projectdir/output/data/referral_byregion_rounded_all.dta", replace emp
> tyok
(note: dataset contains 0 observations)
file /workspace/output/data/referral_byregion_rounded_all.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==.
(37,361 observations deleted)

. drop if region_nospace=="Not known"
(327 observations deleted)

. 
. foreach var of varlist gp_appt_cat_22 gp_appt_cat_21 gp_appt_cat_20 gp_appt_c
> at_19 gp_appt_cat {
  2.         preserve
  3.         contract `var'
  4.         local v : variable label `var' 
  5.         gen variable = `"`v'"'
  6.     decode `var', gen(categories)
  7.         gen count = round(_freq, 5)
  8.         egen total = total(count)
  9.         egen non_missing=sum(count) if categories!=""
 10.         drop if categories==""
 11.         gen percent = round((count/non_missing)*100, 0.1)
 12.         gen missing=(total-non_missing)
 13.         order total, after(percent)
 14.         order missing, after(total)
 15.         gen countstr = string(count)
 16.         replace countstr = "<8" if count<=7
 17.         order countstr, after(count)
 18.         drop count
 19.         rename countstr count_all
 20.         tostring percent, gen(percentstr) force format(%9.1f)
 21.         replace percentstr = "-" if count =="<8"
 22.         order percentstr, after(percent)
 23.         drop percent
 24.         rename percentstr percent_all
 25.         gen totalstr = string(total)
 26.         replace totalstr = "-" if count =="<8"
 27.         order totalstr, after(total)
 28.         drop total
 29.         rename totalstr total_all
 30.         gen missingstr = string(missing)
 31.         replace missingstr = "-" if count =="<8"
 32.         order missingstr, after(missing)
 33.         drop missing
 34.         rename missingstr missing_all
 35.         list variable categories count percent total missing
 36.         keep variable categories count percent total missing
 37.         append using "$projectdir/output/data/referral_byregion_rounded_al
> l.dta"
 38.         save "$projectdir/output/data/referral_byregion_rounded_all.dta", 
> replace
 39.         restore
 40. }
(1 missing value generated)
(1 observation deleted)
(2 real changes made)
percentstr generated as str5
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +--------------------------------------------------------------------+
  1. |                                       variable |        categories |
     | Time to rheumatology assessment, Apr 2022-2023 |    Within 3 weeks |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |          <8    |           -    |           -    |           -     |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  2. |                                       variable |        categories |
     | Time to rheumatology assessment, Apr 2022-2023 | Between 3-6 weeks |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |          <8    |           -    |           -    |           -     |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  3. |                                       variable |        categories |
     | Time to rheumatology assessment, Apr 2022-2023 | More than 6 weeks |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |          55    |       100.0    |       32810    |       32755     |
     +--------------------------------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_all.dta saved
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +--------------------------------------------------------------------+
  1. |                                       variable |        categories |
     | Time to rheumatology assessment, Apr 2021-2022 |    Within 3 weeks |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |          10    |         1.4    |       32815    |       32115     |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  2. |                                       variable |        categories |
     | Time to rheumatology assessment, Apr 2021-2022 | Between 3-6 weeks |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |          <8    |           -    |           -    |           -     |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  3. |                                       variable |        categories |
     | Time to rheumatology assessment, Apr 2021-2022 | More than 6 weeks |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |         685    |        97.9    |       32815    |       32115     |
     +--------------------------------------------------------------------+
(note: variable percent_all was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/referral_byregion_rounded_all.dta saved
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +--------------------------------------------------------------------+
  1. |                                       variable |        categories |
     | Time to rheumatology assessment, Apr 2020-2021 |    Within 3 weeks |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |          85    |         2.8    |       32815    |       29755     |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  2. |                                       variable |        categories |
     | Time to rheumatology assessment, Apr 2020-2021 | Between 3-6 weeks |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |          70    |         2.3    |       32815    |       29755     |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  3. |                                       variable |        categories |
     | Time to rheumatology assessment, Apr 2020-2021 | More than 6 weeks |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |        2905    |        94.9    |       32815    |       29755     |
     +--------------------------------------------------------------------+
(note: variable percent_all was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/referral_byregion_rounded_all.dta saved
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +--------------------------------------------------------------------+
  1. |                                       variable |        categories |
     | Time to rheumatology assessment, Apr 2019-2020 |    Within 3 weeks |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |         315    |         4.5    |       32815    |       25740     |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  2. |                                       variable |        categories |
     | Time to rheumatology assessment, Apr 2019-2020 | Between 3-6 weeks |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |         295    |         4.2    |       32815    |       25740     |
     +--------------------------------------------------------------------+

     +--------------------------------------------------------------------+
  3. |                                       variable |        categories |
     | Time to rheumatology assessment, Apr 2019-2020 | More than 6 weeks |
     |--------------------------------------------------------------------|
     |    count_~l    |    percen~l    |    total_~l    |    missin~l     |
     |        6465    |        91.4    |       32815    |       25740     |
     +--------------------------------------------------------------------+
(note: variable percent_all was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/referral_byregion_rounded_all.dta saved
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +--------------------------------------------------------------+
  1. |                                 variable |        categories |
     | Time to rheumatology assessment, overall |    Within 3 weeks |
     |--------------------------------------------------------------|
     |   count_~l   |   percen~l    |   total_~l    |   missin~l    |
     |        415   |        3.8    |      32815    |      21915    |
     +--------------------------------------------------------------+

     +--------------------------------------------------------------+
  2. |                                 variable |        categories |
     | Time to rheumatology assessment, overall | Between 3-6 weeks |
     |--------------------------------------------------------------|
     |   count_~l   |   percen~l    |   total_~l    |   missin~l    |
     |        375   |        3.4    |      32815    |      21915    |
     +--------------------------------------------------------------+

     +--------------------------------------------------------------+
  3. |                                 variable |        categories |
     | Time to rheumatology assessment, overall | More than 6 weeks |
     |--------------------------------------------------------------|
     |   count_~l   |   percen~l    |   total_~l    |   missin~l    |
     |      10110   |       92.8    |      32815    |      21915    |
     +--------------------------------------------------------------+
(note: variable variable was str40, now str46 to accommodate using data's
       values)
(note: variable percent_all was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/referral_byregion_rounded_all.dta saved

. use "$projectdir/output/data/referral_byregion_rounded_all.dta", clear

. export excel "$projectdir/output/tables/referral_byregion_rounded.xls", repla
> ce sheet("Overall") keepcellfmt firstrow(variables)
file /workspace/output/tables/referral_byregion_rounded.xls saved

. 
. **Boxplot outputs - referral standards, by regions - tagged to above excel
. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==.
(37,361 observations deleted)

. drop if region_nospace=="Not known"
(327 observations deleted)

. 
. local index=0

. levelsof region_nospace, local(levels)
`"East"' `"EastMidlands"' `"London"' `"NorthEast"' `"NorthWest"' `"SouthEast"' 
> `"SouthWest"' `"WestMidlands"' `"YorkshireandTheHumber"'

. foreach i of local levels {
  2.         clear *
  3.         save "$projectdir/output/data/referral_byregion_rounded_`i'.dta", 
> replace emptyok
  4.         di `index'
  5.         if `index'==0 {
  6.                 local col = word("`c(ALPHA)'", `index'+7)
  7.         }
  8.         else if `index'>0 & `index'<=21 {
  9.             local col = word("`c(ALPHA)'", `index'+5)
 10.         }
 11.         else if `index'==22 {
 12.             local col = "AA"
 13.         }
 14.         else if `index'==26 {
 15.             local col = "AE"
 16.         }       
 17.         else if `index'==30 {
 18.             local col = "AI"    
 19.         }       
 20.         else if `index'==34 {
 21.             local col = "AM"
 22.         }
 23.         di "`col'"
 24.         if `index'==0 {
 25.                 local `index++'
 26.                 local `index++'
 27.                 local `index++'
 28.                 local `index++'
 29.                 local `index++'
 30.                 local `index++'
 31.         }
 32.         else {
 33.             local `index++'
 34.                 local `index++'
 35.                 local `index++'
 36.                 local `index++'
 37.         }
 38.         di `index'      
 39. use "$projectdir/output/data/file_eia_all.dta", clear
 40. 
. keep if has_6m_post_appt==1
 41. drop if appt_year>4 | appt_year==.
 42. drop if region_nospace=="Not known"
 43. 
. foreach var of varlist gp_appt_cat_22 gp_appt_cat_21 gp_appt_cat_20 gp_appt_c
> at_19 gp_appt_cat {
 44.         preserve
 45.         keep if region_nospace=="`i'"
 46.         contract `var'
 47.         local v : variable label `var' 
 48.         gen variable = `"`v'"'
 49.     decode `var', gen(categories)
 50.         gen count = round(_freq, 5)
 51.         egen total = total(count)
 52.         egen non_missing=sum(count) if categories!=""
 53.         drop if categories==""
 54.         gen percent = round((count/non_missing)*100, 0.1)
 55.         gen missing=(total-non_missing)
 56.         order total, after(percent)
 57.         order missing, after(total)
 58.         gen countstr = string(count)
 59.         replace countstr = "<8" if count<=7
 60.         order countstr, after(count)
 61.         drop count
 62.         rename countstr count_`i'
 63.         tostring percent, gen(percentstr) force format(%9.1f)
 64.         replace percentstr = "-" if count =="<8"
 65.         order percentstr, after(percent)
 66.         drop percent
 67.         rename percentstr percent_`i'
 68.         gen totalstr = string(total)
 69.         replace totalstr = "-" if count =="<8"
 70.         order totalstr, after(total)
 71.         drop total
 72.         rename totalstr total_`i'
 73.         gen missingstr = string(missing)
 74.         replace missingstr = "-" if count =="<8"
 75.         order missingstr, after(missing)
 76.         drop missing
 77.         rename missingstr missing_`i'
 78.         list count percent total missing
 79.         keep count percent total missing
 80.         append using "$projectdir/output/data/referral_byregion_rounded_`i
> '.dta"
 81.         save "$projectdir/output/data/referral_byregion_rounded_`i'.dta", 
> replace
 82.         restore
 83. }
 84. display `index'
 85. display "`col'"
 86. use "$projectdir/output/data/referral_byregion_rounded_`i'.dta", clear
 87. export excel "$projectdir/output/tables/referral_byregion_rounded.xls", sh
> eet("Overall", modify) cell("`col'1") keepcellfmt firstrow(variables)
 88. }
(note: dataset contains 0 observations)
file /workspace/output/data/referral_byregion_rounded_East.dta saved
0
G
6
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(29,528 observations deleted)
(1 missing value generated)
(1 observation deleted)
variable countstr was str1 now str2
(2 real changes made)
percentstr generated as str5
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_East.dta saved
(29,528 observations deleted)
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str5
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       80      100.0       3290       3210 |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_East.dta saved
(29,528 observations deleted)
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       10        3.3       3290       2985 |
  2. |       <8          -          -          - |
  3. |      290       95.1       3290       2985 |
     +-------------------------------------------+
(note: variable percent_East was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/referral_byregion_rounded_East.dta saved
(29,528 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       30        4.3       3290       2595 |
  2. |       35        5.0       3290       2595 |
  3. |      630       90.6       3290       2595 |
     +-------------------------------------------+
(note: variable percent_East was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/referral_byregion_rounded_East.dta saved
(29,528 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       40        3.7       3290       2205 |
  2. |       40        3.7       3290       2205 |
  3. |     1005       92.6       3290       2205 |
     +-------------------------------------------+
(note: variable percent_East was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/referral_byregion_rounded_East.dta saved
6
G
file /workspace/output/tables/referral_byregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/referral_byregion_rounded_EastMidlands.dta saved
6
K
10
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(29,564 observations deleted)
(1 missing value generated)
(1 observation deleted)
variable countstr was str1 now str2
(1 real change made)
percentstr generated as str5
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       <8          -          -          - |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_EastMidlands.dta saved
(29,564 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str5
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       70      100.0       3255       3185 |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_EastMidlands.dta saved
(29,564 observations deleted)
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       10        3.2       3250       2940 |
  3. |      295       95.2       3250       2940 |
     +-------------------------------------------+
(note: variable percent_EastMidlands was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_EastMidlands.dta saved
(29,564 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       25        3.5       3250       2530 |
  2. |       25        3.5       3250       2530 |
  3. |      670       93.1       3250       2530 |
     +-------------------------------------------+
(note: variable percent_EastMidlands was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_EastMidlands.dta saved
(29,564 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       35        3.2       3255       2145 |
  2. |       35        3.2       3255       2145 |
  3. |     1040       93.7       3255       2145 |
     +-------------------------------------------+
(note: variable percent_EastMidlands was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_EastMidlands.dta saved
10
K
file /workspace/output/tables/referral_byregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/referral_byregion_rounded_London.dta saved
10
O
14
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(26,299 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str5
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~n   percen~n   total_~n   missin~n |
     |-------------------------------------------|
  1. |       10      100.0       6520       6510 |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_London.dta saved
(26,299 observations deleted)
(1 missing value generated)
(1 observation deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +-------------------------------------------+
     | count_~n   percen~n   total_~n   missin~n |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
  3. |      155       96.9       6520       6360 |
     +-------------------------------------------+
(note: variable percent_London was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/referral_byregion_rounded_London.dta saved
(26,299 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~n   percen~n   total_~n   missin~n |
     |-------------------------------------------|
  1. |       15        2.4       6520       5905 |
  2. |       15        2.4       6520       5905 |
  3. |      585       95.1       6520       5905 |
     +-------------------------------------------+
(note: variable percent_London was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/referral_byregion_rounded_London.dta saved
(26,299 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~n   percen~n   total_~n   missin~n |
     |-------------------------------------------|
  1. |       65        4.6       6520       5120 |
  2. |       65        4.6       6520       5120 |
  3. |     1270       90.7       6520       5120 |
     +-------------------------------------------+
(note: variable percent_London was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/referral_byregion_rounded_London.dta saved
(26,299 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~n   percen~n   total_~n   missin~n |
     |-------------------------------------------|
  1. |       80        3.7       6515       4340 |
  2. |       80        3.7       6515       4340 |
  3. |     2015       92.6       6515       4340 |
     +-------------------------------------------+
(note: variable percent_London was str4, now str5 to accommodate using data's
       values)
file /workspace/output/data/referral_byregion_rounded_London.dta saved
14
O
file /workspace/output/tables/referral_byregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/referral_byregion_rounded_NorthEast.dta saved
14
S
18
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(29,528 observations deleted)
(1 missing value generated)
(1 observation deleted)
variable countstr was str1 now str2
(2 real changes made)
percentstr generated as str5
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_NorthEast.dta saved
(29,528 observations deleted)
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str5
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       55      100.0       3285       3230 |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_NorthEast.dta saved
(29,528 observations deleted)
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       15        4.8       3295       2980 |
  2. |       <8          -          -          - |
  3. |      295       93.7       3295       2980 |
     +-------------------------------------------+
(note: variable percent_NorthEast was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_NorthEast.dta saved
(29,528 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       20        2.8       3290       2585 |
  2. |       30        4.3       3290       2585 |
  3. |      655       92.9       3290       2585 |
     +-------------------------------------------+
(note: variable percent_NorthEast was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_NorthEast.dta saved
(29,528 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       35        3.3       3285       2210 |
  2. |       30        2.8       3285       2210 |
  3. |     1010       94.0       3285       2210 |
     +-------------------------------------------+
(note: variable percent_NorthEast was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_NorthEast.dta saved
18
S
file /workspace/output/tables/referral_byregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/referral_byregion_rounded_NorthWest.dta saved
18
W
22
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(29,508 observations deleted)
(1 missing value generated)
(1 observation deleted)
variable countstr was str1 now str2
(2 real changes made)
percentstr generated as str5
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_NorthWest.dta saved
(29,508 observations deleted)
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       70       93.3       3310       3235 |
     +-------------------------------------------+
(note: variable percent_NorthWest was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_NorthWest.dta saved
(29,508 observations deleted)
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       10        3.3       3310       3005 |
  2. |       <8          -          -          - |
  3. |      290       95.1       3310       3005 |
     +-------------------------------------------+
(note: variable percent_NorthWest was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_NorthWest.dta saved
(29,508 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       35        4.9       3305       2595 |
  2. |       20        2.8       3305       2595 |
  3. |      655       92.3       3305       2595 |
     +-------------------------------------------+
(note: variable percent_NorthWest was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_NorthWest.dta saved
(29,508 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       50        4.5       3310       2210 |
  2. |       30        2.7       3310       2210 |
  3. |     1020       92.7       3310       2210 |
     +-------------------------------------------+
(note: variable percent_NorthWest was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_NorthWest.dta saved
22
W
file /workspace/output/tables/referral_byregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/referral_byregion_rounded_SouthEast.dta saved
22
AA
26
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(29,557 observations deleted)
(1 missing value generated)
(1 observation deleted)
variable countstr was str1 now str2
(1 real change made)
percentstr generated as str5
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_SouthEast.dta saved
(29,557 observations deleted)
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str5
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       55      100.0       3260       3205 |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_SouthEast.dta saved
(29,557 observations deleted)
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       10        3.2       3255       2945 |
  2. |       <8          -          -          - |
  3. |      295       95.2       3255       2945 |
     +-------------------------------------------+
(note: variable percent_SouthEast was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_SouthEast.dta saved
(29,557 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       30        4.3       3265       2565 |
  2. |       35        5.0       3265       2565 |
  3. |      635       90.7       3265       2565 |
     +-------------------------------------------+
(note: variable percent_SouthEast was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_SouthEast.dta saved
(29,557 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       40        3.7       3255       2185 |
  2. |       40        3.7       3255       2185 |
  3. |      990       92.5       3255       2185 |
     +-------------------------------------------+
(note: variable percent_SouthEast was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_SouthEast.dta saved
26
AA
file /workspace/output/tables/referral_byregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/referral_byregion_rounded_SouthWest.dta saved
26
AE
30
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(29,563 observations deleted)
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str5
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       10      100.0       3250       3240 |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_SouthWest.dta saved
(29,563 observations deleted)
(1 missing value generated)
(1 observation deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
  3. |       60       92.3       3255       3190 |
     +-------------------------------------------+
(note: variable percent_SouthWest was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_SouthWest.dta saved
(29,563 observations deleted)
(1 missing value generated)
(1 observation deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
  3. |      275       96.5       3250       2965 |
     +-------------------------------------------+
(note: variable percent_SouthWest was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_SouthWest.dta saved
(29,563 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       40        5.3       3255       2500 |
  2. |       25        3.3       3255       2500 |
  3. |      690       91.4       3255       2500 |
     +-------------------------------------------+
(note: variable percent_SouthWest was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_SouthWest.dta saved
(29,563 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~t   percen~t   total_~t   missin~t |
     |-------------------------------------------|
  1. |       50        4.5       3255       2135 |
  2. |       35        3.1       3255       2135 |
  3. |     1035       92.4       3255       2135 |
     +-------------------------------------------+
(note: variable percent_SouthWest was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_SouthWest.dta saved
30
AE
file /workspace/output/tables/referral_byregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/referral_byregion_rounded_WestMidlands.dta saved
30
AI
34
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(29,491 observations deleted)
(1 missing value generated)
(1 observation deleted)
variable countstr was str1 now str2
(1 real change made)
percentstr generated as str5
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       <8          -          -          - |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_WestMidlands.dta saved
(29,491 observations deleted)
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str5
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       75      100.0       3325       3250 |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_WestMidlands.dta saved
(29,491 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       10        3.1       3325       3000 |
  2. |       15        4.6       3325       3000 |
  3. |      300       92.3       3325       3000 |
     +-------------------------------------------+
(note: variable percent_WestMidlands was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_WestMidlands.dta saved
(29,491 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       35        5.1       3325       2645 |
  2. |       25        3.7       3325       2645 |
  3. |      620       91.2       3325       2645 |
     +-------------------------------------------+
(note: variable percent_WestMidlands was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_WestMidlands.dta saved
(29,491 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~s   percen~s   total_~s   missin~s |
     |-------------------------------------------|
  1. |       45        4.2       3320       2240 |
  2. |       40        3.7       3320       2240 |
  3. |      995       92.1       3320       2240 |
     +-------------------------------------------+
(note: variable percent_WestMidlands was str4, now str5 to accommodate using
       data's values)
file /workspace/output/data/referral_byregion_rounded_WestMidlands.dta saved
34
AI
file /workspace/output/tables/referral_byregion_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/referral_byregion_rounded_YorkshireandTheHumber.dta
>  saved
34
AM
38
(103,305 observations deleted)
(37,361 observations deleted)
(327 observations deleted)
(29,498 observations deleted)
(1 missing value generated)
(1 observation deleted)
variable countstr was str1 now str2
(1 real change made)
percentstr generated as str5
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~r   percen~r   total_~r   missin~r |
     |-------------------------------------------|
  1. |       <8          -          -          - |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_YorkshireandTheHumber.dta
>  saved
(29,498 observations deleted)
(1 missing value generated)
(1 observation deleted)
(1 real change made)
percentstr generated as str5
(1 real change made)
(1 real change made)
(1 real change made)

     +-------------------------------------------+
     | count_~r   percen~r   total_~r   missin~r |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       65      100.0       3315       3250 |
     +-------------------------------------------+
file /workspace/output/data/referral_byregion_rounded_YorkshireandTheHumber.dta
>  saved
(29,498 observations deleted)
(1 missing value generated)
(1 observation deleted)
(2 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(2 real changes made)
(2 real changes made)
(2 real changes made)

     +-------------------------------------------+
     | count_~r   percen~r   total_~r   missin~r |
     |-------------------------------------------|
  1. |       <8          -          -          - |
  2. |       <8          -          -          - |
  3. |      280       96.6       3315       3025 |
     +-------------------------------------------+
(note: variable percent_YorkshireandTheHumber was str4, now str5 to
       accommodate using data's values)
file /workspace/output/data/referral_byregion_rounded_YorkshireandTheHumber.dta
>  saved
(29,498 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~r   percen~r   total_~r   missin~r |
     |-------------------------------------------|
  1. |       35        4.9       3320       2605 |
  2. |       35        4.9       3320       2605 |
  3. |      645       90.2       3320       2605 |
     +-------------------------------------------+
(note: variable percent_YorkshireandTheHumber was str4, now str5 to
       accommodate using data's values)
file /workspace/output/data/referral_byregion_rounded_YorkshireandTheHumber.dta
>  saved
(29,498 observations deleted)
(1 missing value generated)
(1 observation deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)
(0 real changes made)

     +-------------------------------------------+
     | count_~r   percen~r   total_~r   missin~r |
     |-------------------------------------------|
  1. |       40        3.7       3315       2240 |
  2. |       45        4.2       3315       2240 |
  3. |      990       92.1       3315       2240 |
     +-------------------------------------------+
(note: variable percent_YorkshireandTheHumber was str4, now str5 to
       accommodate using data's values)
file /workspace/output/data/referral_byregion_rounded_YorkshireandTheHumber.dta
>  saved
38
AM
file /workspace/output/tables/referral_byregion_rounded.xls saved

. 
. **Rheumatology appointment consultation medium for all years
. clear *

. save "$projectdir/output/data/consultation_medium.dta", replace emptyok
(note: dataset contains 0 observations)
file /workspace/output/data/consultation_medium.dta saved

. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==.
(37,361 observations deleted)

. 
. foreach var of varlist rheum_appt_medium {
  2.         preserve
  3.         contract `var'
  4.         gen count = round(_freq, 5)
  5.         egen total = total(count)
  6.         gen percent = round((count/total)*100, 0.1)
  7.         order total, after(percent)
  8.         gen countstr = string(count)
  9.         replace countstr = "<8" if count<=7
 10.         order countstr, after(count)
 11.         drop count
 12.         rename countstr count_all
 13.         tostring percent, gen(percentstr) force format(%9.1f)
 14.         replace percentstr = "-" if count =="<8"
 15.         order percentstr, after(percent)
 16.         drop percent
 17.         rename percentstr percent_all
 18.         gen totalstr = string(total)
 19.         replace totalstr = "-" if count =="<8"
 20.         order totalstr, after(total)
 21.         drop total
 22.         rename totalstr total_all
 23.         list rheum_appt_medium count percent total
 24.         keep rheum_appt_medium count percent total
 25.         append using "$projectdir/output/data/consultation_medium.dta"
 26.         save "$projectdir/output/data/consultation_medium.dta", replace
 27.         restore
 28. }
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +-----------------------------------------------+
     | rheum_appt~m   count_~l   percen~l   total_~l |
     |-----------------------------------------------|
  1. | Face-to-face       6000       18.1      33140 |
  2. |    Telephone       5960       18.0      33140 |
  3. |        Other      17860       53.9      33140 |
  4. |      Missing       3320       10.0      33140 |
     +-----------------------------------------------+
file /workspace/output/data/consultation_medium.dta saved

. use "$projectdir/output/data/consultation_medium.dta", clear

. export excel "$projectdir/output/tables/consultation_medium_rounded.xls", rep
> lace sheet("Overall") keepcellfmt firstrow(variables)
file /workspace/output/tables/consultation_medium_rounded.xls saved

. 
. **Rheumatology appointment consultation medium table by year
. use "$projectdir/output/data/file_eia_all.dta", clear

. 
. keep if has_6m_post_appt==1
(103,305 observations deleted)

. drop if appt_year>4 | appt_year==.
(37,361 observations deleted)

. 
. recode appt_year 1=2019
(appt_year: 25685 changes made)

. recode appt_year 2=2020
(appt_year: 6363 changes made)

. recode appt_year 3=2021
(appt_year: 1027 changes made)

. recode appt_year 4=2022
(appt_year: 69 changes made)

. 
. local index=0

. levelsof appt_year, local(levels)
2019 2020 2021 2022

. foreach i of local levels {
  2.         clear *
  3.         save "$projectdir/output/data/consultation_medium_`i'.dta", replac
> e emptyok
  4. di `index'
  5.         if `index'==0 {
  6.                 local col = word("`c(ALPHA)'", `index'+5)
  7.         }
  8.         else if `index'>0 & `index'<=21 {
  9.             local col = word("`c(ALPHA)'", `index'+4)
 10.         }
 11.         di "`col'"
 12.         if `index'==0 {
 13.                 local `index++'
 14.                 local `index++'
 15.                 local `index++'
 16.                 local `index++'
 17.         }
 18.         else {
 19.             local `index++'
 20.                 local `index++'
 21.                 local `index++'
 22.         }
 23.         di `index'
 24.         
. use "$projectdir/output/data/file_eia_all.dta", clear
 25. 
. keep if has_6m_post_appt==1
 26. drop if appt_year>4 | appt_year==.
 27. 
. recode appt_year 1=2019
 28. recode appt_year 2=2020
 29. recode appt_year 3=2021
 30. recode appt_year 4=2022
 31. 
. foreach var of varlist rheum_appt_medium {
 32.         preserve
 33.         keep if appt_year==`i'
 34.         contract `var'
 35.         gen count = round(_freq, 5)
 36.         egen total = total(count)
 37.         gen percent = round((count/total)*100, 0.1)
 38.         order total, after(percent)
 39.         gen countstr = string(count)
 40.         replace countstr = "<8" if count<=7
 41.         order countstr, after(count)
 42.         drop count
 43.         rename countstr count_`i'
 44.         tostring percent, gen(percentstr) force format(%9.1f)
 45.         replace percentstr = "-" if count =="<8"
 46.         order percentstr, after(percent)
 47.         drop percent
 48.         rename percentstr percent_`i'
 49.         gen totalstr = string(total)
 50.         replace totalstr = "-" if count =="<8"
 51.         order totalstr, after(total)
 52.         drop total
 53.         rename totalstr total_`i'
 54.         list count percent total
 55.         keep count percent total
 56.         append using "$projectdir/output/data/consultation_medium_`i'.dta"
 57.         save "$projectdir/output/data/consultation_medium_`i'.dta", replac
> e
 58.         restore
 59. }
 60. 
. display `index'
 61. display "`col'"
 62. use "$projectdir/output/data/consultation_medium_`i'.dta", clear
 63. export excel "$projectdir/output/tables/consultation_medium_rounded.xls", 
> sheet("Overall", modify) cell("`col'1") keepcellfmt firstrow(variables)
 64. }
(note: dataset contains 0 observations)
file /workspace/output/data/consultation_medium_2019.dta saved
0
E
4
(103,305 observations deleted)
(37,361 observations deleted)
(appt_year: 25685 changes made)
(appt_year: 6363 changes made)
(appt_year: 1027 changes made)
(appt_year: 69 changes made)
(7,459 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | cou~2019   per~2019   tot~2019 |
     |--------------------------------|
  1. |     4655       18.1      25685 |
  2. |     4600       17.9      25685 |
  3. |    13850       53.9      25685 |
  4. |     2580       10.0      25685 |
     +--------------------------------+
file /workspace/output/data/consultation_medium_2019.dta saved
4
E
file /workspace/output/tables/consultation_medium_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/consultation_medium_2020.dta saved
4
H
7
(103,305 observations deleted)
(37,361 observations deleted)
(appt_year: 25685 changes made)
(appt_year: 6363 changes made)
(appt_year: 1027 changes made)
(appt_year: 69 changes made)
(26,781 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | cou~2020   per~2020   tot~2020 |
     |--------------------------------|
  1. |     1165       18.3       6360 |
  2. |     1145       18.0       6360 |
  3. |     3420       53.8       6360 |
  4. |      630        9.9       6360 |
     +--------------------------------+
file /workspace/output/data/consultation_medium_2020.dta saved
7
H
file /workspace/output/tables/consultation_medium_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/consultation_medium_2021.dta saved
7
K
10
(103,305 observations deleted)
(37,361 observations deleted)
(appt_year: 25685 changes made)
(appt_year: 6363 changes made)
(appt_year: 1027 changes made)
(appt_year: 69 changes made)
(32,117 observations deleted)
(0 real changes made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(0 real changes made)
(0 real changes made)

     +--------------------------------+
     | cou~2021   per~2021   tot~2021 |
     |--------------------------------|
  1. |      170       16.6       1025 |
  2. |      205       20.0       1025 |
  3. |      550       53.7       1025 |
  4. |      100        9.8       1025 |
     +--------------------------------+
file /workspace/output/data/consultation_medium_2021.dta saved
10
K
file /workspace/output/tables/consultation_medium_rounded.xls saved
(note: dataset contains 0 observations)
file /workspace/output/data/consultation_medium_2022.dta saved
10
N
13
(103,305 observations deleted)
(37,361 observations deleted)
(appt_year: 25685 changes made)
(appt_year: 6363 changes made)
(appt_year: 1027 changes made)
(appt_year: 69 changes made)
(33,075 observations deleted)
(1 real change made)
percentstr generated as str4
percentstr was forced to string; some loss of information
(1 real change made)
(1 real change made)

     +--------------------------------+
     | cou~2022   per~2022   tot~2022 |
     |--------------------------------|
  1. |       <8          -          - |
  2. |       10       15.4         65 |
  3. |       40       61.5         65 |
  4. |       10       15.4         65 |
     +--------------------------------+
file /workspace/output/data/consultation_medium_2022.dta saved
13
N
file /workspace/output/tables/consultation_medium_rounded.xls saved

. 
. *Output tables as CSVs           
. import excel "$projectdir/output/tables/table_1_rounded_bydiag.xls", clear
(21 vars, 59 obs)

. export delimited using "$projectdir/output/tables/table_1_rounded_bydiag.csv"
>  , novarnames  replace             
(note: file /workspace/output/tables/table_1_rounded_bydiag.csv not found)
file /workspace/output/tables/table_1_rounded_bydiag.csv saved

. 
. import excel "$projectdir/output/tables/table_mean_bydiag_rounded.xls", clear
(5 vars, 11 obs)

. export delimited using "$projectdir/output/tables/table_mean_bydiag_rounded.c
> sv" , novarnames  replace          
(note: file /workspace/output/tables/table_mean_bydiag_rounded.csv not found)
file /workspace/output/tables/table_mean_bydiag_rounded.csv saved

. 
. import excel "$projectdir/output/tables/table_median_bydiag_rounded.xls", cle
> ar
(6 vars, 11 obs)

. export delimited using "$projectdir/output/tables/table_median_bydiag_rounded
> .csv" , novarnames  replace                
(note: file /workspace/output/tables/table_median_bydiag_rounded.csv not found)
file /workspace/output/tables/table_median_bydiag_rounded.csv saved

. 
. import excel "$projectdir/output/tables/table_median_bydiag_rounded_to21.xls"
> , clear
(22 vars, 16 obs)

. export delimited using "$projectdir/output/tables/table_median_bydiag_rounded
> _to21.csv" , novarnames  replace
(note: file /workspace/output/tables/table_median_bydiag_rounded_to21.csv not f
> ound)
file /workspace/output/tables/table_median_bydiag_rounded_to21.csv saved

. 
. import excel "$projectdir/output/tables/table_median_bydiag_rounded_to21_repo
> rt.xls", clear
(30 vars, 6 obs)

. export delimited using "$projectdir/output/tables/table_median_bydiag_rounded
> _to21_report.csv" , novarnames  replace            
(note: file /workspace/output/tables/table_median_bydiag_rounded_to21_report.cs
> v not found)
file /workspace/output/tables/table_median_bydiag_rounded_to21_report.csv saved

. 
. import excel "$projectdir/output/tables/ITSA_tables_appt_delay_rounded.xls", 
> clear
(4 vars, 41 obs)

. export delimited using "$projectdir/output/tables/ITSA_tables_appt_delay_roun
> ded.csv" , novarnames  replace             
(note: file /workspace/output/tables/ITSA_tables_appt_delay_rounded.csv not fou
> nd)
file /workspace/output/tables/ITSA_tables_appt_delay_rounded.csv saved

. 
. import excel "$projectdir/output/tables/ITSA_tables_csdmard_delay_rounded.xls
> ", clear
(4 vars, 41 obs)

. export delimited using "$projectdir/output/tables/ITSA_tables_csdmard_delay_r
> ounded.csv" , novarnames  replace  
(note: file /workspace/output/tables/ITSA_tables_csdmard_delay_rounded.csv not 
> found)
file /workspace/output/tables/ITSA_tables_csdmard_delay_rounded.csv saved

. 
. import excel "$projectdir/output/tables/drug_byyearanddisease_rounded.xls", c
> lear
(14 vars, 29 obs)

. export delimited using "$projectdir/output/tables/drug_byyearanddisease_round
> ed.csv" , novarnames  replace              
(note: file /workspace/output/tables/drug_byyearanddisease_rounded.csv not foun
> d)
file /workspace/output/tables/drug_byyearanddisease_rounded.csv saved

. 
. import excel "$projectdir/output/tables/first_csdmard_rounded.xls", clear
(16 vars, 4 obs)

. export delimited using "$projectdir/output/tables/first_csdmard_rounded.csv" 
> , novarnames  replace      
(note: file /workspace/output/tables/first_csdmard_rounded.csv not found)
file /workspace/output/tables/first_csdmard_rounded.csv saved

. 
. import excel "$projectdir/output/tables/first_csdmard_rounded_report.xls", cl
> ear
(29 vars, 4 obs)

. export delimited using "$projectdir/output/tables/first_csdmard_rounded_repor
> t.csv" , novarnames  replace       
(note: file /workspace/output/tables/first_csdmard_rounded_report.csv not found
> )
file /workspace/output/tables/first_csdmard_rounded_report.csv saved

. 
. import excel "$projectdir/output/tables/drug_byyearandregion_rounded.xls", cl
> ear
(42 vars, 20 obs)

. export delimited using "$projectdir/output/tables/drug_byyearandregion_rounde
> d.csv" , novarnames  replace       
(note: file /workspace/output/tables/drug_byyearandregion_rounded.csv not found
> )
file /workspace/output/tables/drug_byyearandregion_rounded.csv saved

. 
. import excel "$projectdir/output/tables/referral_byregion_rounded.xls", clear
(42 vars, 16 obs)

. export delimited using "$projectdir/output/tables/referral_byregion_rounded.c
> sv" , novarnames  replace          
(note: file /workspace/output/tables/referral_byregion_rounded.csv not found)
file /workspace/output/tables/referral_byregion_rounded.csv saved

. 
. import excel "$projectdir/output/tables/consultation_medium_rounded.xls", cle
> ar
(16 vars, 5 obs)

. export delimited using "$projectdir/output/tables/consultation_medium_rounded
> .csv" , novarnames  replace                
(note: file /workspace/output/tables/consultation_medium_rounded.csv not found)
file /workspace/output/tables/consultation_medium_rounded.csv saved

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/redacted_tables.log
  log type:  text
 closed on:  16 Jan 2023, 12:14:46
-------------------------------------------------------------------------------
